<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 2: t-tests • FANR6750</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 2: t-tests">
<meta property="og:description" content="FANR6750">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FANR6750</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2021.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/01_basic_stats/01_basic_stats.html">Lecture 1: Basic concepts in statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/02_t-tests/02_t-tests.html">Lecture 2: t-tests</a>
    </li>
    <li>
      <a href="../articles/lectures/03_anova/03_anova.html">Lecture 3: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/04_mult_comparisons/04_mult_comparisons.html">Lecture 4: Multiple comparisons</a>
    </li>
    <li>
      <a href="../articles/lectures/05_contrasts/05_contrasts.html">Lecture 5: Contrasts</a>
    </li>
    <li>
      <a href="../articles/lectures/06_power-analysis/06_power-analysis.html">Lecture 6: Power analysis</a>
    </li>
    <li>
      <a href="../articles/lectures/07_estimation/07_estimation.html">Lecture 7: Estimation</a>
    </li>
    <li>
      <a href="../articles/lectures/08_assumptions/08_assumptions.html">Lecture 8: ANOVA assumptions</a>
    </li>
    <li>
      <a href="../articles/lectures/09_nonparametrics/09_nonparametrics.html">Lecture 9: Non-parametric statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/10_blocking/10_blocking.html">Lecture 10: Blocking</a>
    </li>
    <li>
      <a href="../articles/lectures/11_raneff/11_raneff.html">Lecture 11: Random effects</a>
    </li>
    <li>
      <a href="../articles/lectures/12_factorial/12_factorial.html">Lecture 12: Factorial designs</a>
    </li>
    <li>
      <a href="../articles/lectures/13_nesting/13_nesting.html">Lecture 13: Nested designs</a>
    </li>
    <li>
      <a href="../articles/lectures/14_splitplot/14_splitplot.html">Lecture 14: Split plot designs</a>
    </li>
    <li>
      <a href="../articles/lectures/15_repeated_measures/15_repeated_measures.html">Lecture 15: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lectures/16_ANCOVA/16_ANCOVA.html">Lecture 16: ANCOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/17_lm/17_lm.html">Lecture 17: Linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/18_glm/18_glm.html">Lecture 18: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/19_model_selection/19_model_selection.html">Lecture 19: Model selection</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab01_Intro_to_R.html">Lab 1: Introduction to R</a>
    </li>
    <li>
      <a href="../articles/lab02_t-tests.html">Lab 2: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab03_ANOVA.html">Lab 3: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab04_contrasts.html">Lab 4: Contrasts, estimation, and power analysis</a>
    </li>
    <li>
      <a href="../articles/lab05_assump_nonpar.html">Lab 5: Assumptions of ANOVA, tranformations, and non-parametric tests</a>
    </li>
    <li>
      <a href="../articles/lab06_blocking.html">Lab 6: Randomized Complete Block Design</a>
    </li>
    <li>
      <a href="../articles/lab07_factorial.html">Lab 7: Factorial designs</a>
    </li>
    <li>
      <a href="../articles/lab08_nested.html">Lab 8: Nested ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab09_splitplot.html">Lab 9: Split plot designs</a>
    </li>
    <li>
      <a href="../articles/lab10_repeated_measures.html">Lab 10: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lab11_ANCOVA.html">Lab 11: ANCOVA</a>
    </li>
    <li>
      <a href="../articles/lab12_lm.html">Lab 12: Linear models</a>
    </li>
    <li>
      <a href="../articles/lab13_glm.html">Lab 13: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/lab14_model_selection.html">Lab 14: Model selection and multi-model inference</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework.html">Assignment instructions</a>
    </li>
    <li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/RMarkdown.html">R Markdown reference</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="lab02_t-tests_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 2: t-tests</h1>
            <h3 class="subtitle">FANR 6750: Experimental Methods in Forestry and Natural Resources Research</h3>
                        <h4 class="author">Fall 2021</h4>
            
      
      
      <div class="hidden name"><code>lab02_t-tests.Rmd</code></div>

    </div>

    
    
<div id="last-week" class="section level2">
<h2 class="hasAnchor">
<a href="#last-week" class="anchor"></a>Last week</h2>
<ul>
<li><p>Using <code>R</code> as calculator</p></li>
<li><p>Scripts</p></li>
<li><p>Vectors and object classes</p></li>
<li><p>Subsetting vectors</p></li>
<li><p>Built-in functions/help</p></li>
<li><p>Data frames</p></li>
<li><p>Subsetting data frames</p></li>
</ul>
</div>
<div id="todays-topics" class="section level2">
<h2 class="hasAnchor">
<a href="#todays-topics" class="anchor"></a>Today’s topics</h2>
<ol style="list-style-type: decimal">
<li><p>Introduction</p></li>
<li><p>Graphics</p></li>
<li>
<p><em>t</em>-tests</p>
<ul>
<li><p>Two-sample t test</p></li>
<li><p>Equality of variance test</p></li>
<li><p>Paired t-test</p></li>
</ul>
</li>
</ol>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<div id="scenario" class="section level2">
<h2 class="hasAnchor">
<a href="#scenario" class="anchor"></a>Scenario</h2>
<ul>
<li><p>We have 2 samples of data</p></li>
<li><p><strong>Question</strong>: Do the samples come from the same population, or do they come from populations with different means?</p></li>
<li><p><strong>Problem</strong>: We don’t know the true population means (<span class="math inline">\(\mu_1\)</span>, <span class="math inline">\(\mu_2\)</span>)</p></li>
<li>
<p>Under the assumption that the variances of the two populations are equal, the relevant hypotheses are:</p>
<ul>
<li><p><span class="math inline">\(H_0 : \mu_1 = \mu_2\)</span></p></li>
<li><p><span class="math inline">\(H_A : \mu_1 \neq \mu_2\)</span></p></li>
</ul>
</li>
</ul>
<p><img src="lab02_t-tests_files/figure-html/unnamed-chunk-1-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="key-points" class="section level2">
<h2 class="hasAnchor">
<a href="#key-points" class="anchor"></a>Key points</h2>
<ul>
<li><p>If the two sample means (<span class="math inline">\(\bar{y}_1\)</span>, <span class="math inline">\(\bar{y}_2\)</span>) are very different and the standard error of the difference in means is small, the <span class="math inline">\(t\)</span>-statistic will be far from zero</p></li>
<li><p>If the <span class="math inline">\(t\)</span>-statistic is more extreme than the critical values, we reject the null hypothesis (<span class="math inline">\(H_0\)</span>)</p></li>
</ul>
<p><img src="lab02_t-tests_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="exercise-1" class="section level2">
<h2 class="hasAnchor">
<a href="#exercise-1" class="anchor"></a>Exercise 1</h2>
<ol style="list-style-type: decimal">
<li><p>Open your <code>FANR6750</code> RStudio project (if you have one)</p></li>
<li><p>Create a new <code>R</code> script and save it to the directory where you store you lab activities. Name it something like <code>lab02-t_tests.R</code></p></li>
<li><p>Load the <code>FANR6750</code> package and the <code>treedata</code> object</p></li>
</ol>
<pre><code><a href="https://rdrr.io/r/base/library.html">library(FANR6750)
data("treedata")</a></code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Create 2 objects: <code>yL</code> is the tree density data for the first 10 experimental units (low elevation), and <code>yH</code> is the tree density data for the last 10 units (high elevation)</li>
</ol>
<pre><code>yL &lt;- treedata$density[treedata$elevation == "Low"]

yH &lt;- treedata$density[treedata$elevation == "High"]</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Create objects that contain the mean, variance, and standard deviation of the 2 samples</li>
</ol>
<pre><code>mean.L &lt;- ?
mean.H &lt;- ?

s2.L &lt;- ?
s2.H &lt;- ?

s.L &lt;- ?
s.H &lt;- ?</code></pre>
</div>
</div>
<div id="graphics" class="section level1">
<h1 class="hasAnchor">
<a href="#graphics" class="anchor"></a>Graphics</h1>
<p><code>R</code> has very powerful graphing capabilities that make it possible to create data visualizations for reports or publications. As with most tasks in <code>R</code>, there are many ways to create graphs and you will find that people have very strong feelings about the best approach.</p>
<p>The debate over graphics in <code>R</code> usually boils down to using the built-in graphing functions (“base graphics”) vs the <code>ggplot2</code> package. Full disclosure, I much prefer <code>ggplot2</code> and therefore most of the sample code provided in lab will reflect that preference. However, <strong>I don’t care how you make your plots as long as they effectively display the information you are trying to convey</strong>. If you prefer base graphics, by all means use base graphics.</p>
<div id="brief-introduction-to-ggplot2" class="section level3">
<h3 class="hasAnchor">
<a href="#brief-introduction-to-ggplot2" class="anchor"></a>Brief introduction to <code>ggplot2</code>
</h3>
<p>Because the code I provide will use <code>ggplot2</code>, it is worth briefly learning/reviewing how this package approaches data visualization.</p>
<p>The power and flexibility of <code>ggplot2</code> come from it’s consistent structure. Although a bit confusing at first, once you get the hang of it, the structure actually makes it quite easy to create highly customized visualizations. All plots created using <code>ggplot2</code> use the same underlying structure:</p>
<p><span class="math display">\[\underbrace{ggplot}_{initiate\; plot}(\underbrace{data = df}_{data\;frame},\; \underbrace{aes(x =\; , y = \;)}_{plot\; attributes}) + \underbrace{geom\_line()}_{geometry}\]</span></p>
<p>The <code>ggplot()</code> function initiates a new plot. In this function, you tell <code>ggplot2</code> what data frame you will be using for the plot (<code>ggplot</code> only accepts data frames as input) and you tell it how to map attributes of the data to the visual properties of the figures. Attributes are mapped inside the <code>aes()</code> argument. Attributes usually include location (<code>x-axis</code> and <code>y-axis</code> placement), color, size, shape, line type, and many others. In general, <strong>each attribute will be mapped to one column of your data frame</strong>.</p>
<p>The <code>ggplot()</code> function simply initiates a graph - if you run just that portion of the code you will get a blank graph. We can see that by creating a new plot showing the relationship between <code>elevation</code> (the x-axis of the plot) and <code>density</code> (the y-axis):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">treedata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="lab02_t-tests_files/figure-html/unnamed-chunk-3-1.png" width="480" style="display: block; margin: auto;"></p>
<p>You can see that <code>ggplot</code> created a figure with the correct axes and labels. But no data. That’s because we didn’t tell <code>ggplot</code> what type of <em>geometry</em> to use to represent the data. Geometry refers to the type geometric object(s) we want to use to display the data. Common geometries include points (e.g., scatter plot), lines (e.g., time series), and bars (e.g., histograms). There are many others. Once we add a geometry, we can see the data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">treedata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="lab02_t-tests_files/figure-html/unnamed-chunk-4-1.png" width="480" style="display: block; margin: auto;"></p>
<p>In this case, a boxplot might make more sense:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">treedata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="lab02_t-tests_files/figure-html/unnamed-chunk-5-1.png" width="480" style="display: block; margin: auto;"></p>
<p>It’s also possible to use more than one geometry:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">treedata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="lab02_t-tests_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;"></p>
<p>This is reasonable figure showing tree densitys as a function of elevation. But <code>ggplot2</code> makes it very easy to tweak the way the data is visualized (maybe too easy, you can spend <em>a lot</em> of time tweaking minor details). For example, maybe we want to color the points based on the elevation. Because we want to map an <em>attribute</em> (color) to a <em>variable</em> (elevation), we make this change inside of <code>aes</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">treedata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">density</span>, color <span class="op">=</span> <span class="va">elevation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="lab02_t-tests_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></p>
<p>That’s not exactly what we wanted. Both the boxplot and the points now colored a function of <code>elevation</code>. To make just the points a function of elevation, we specify <code>color = elevation</code> inside of the <code>geom_point()</code> function (anything in the <code>ggplot()</code> function will apply to all geoms):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">treedata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">elevation</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="lab02_t-tests_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;"></p>
<p>We can also do things like the change the size of the geometries. In this case, we are <strong>not</strong> mapping a variable to an attribute (size is not a function of the data values). So these changes happen <strong>outside</strong> of the <code>aes()</code> argument:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">treedata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">elevation</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p><img src="lab02_t-tests_files/figure-html/unnamed-chunk-9-1.png" width="480" style="display: block; margin: auto;"></p>
<p>One last example. Because many of the points overlap, it can be hard to tell how many individual points there are in each group. One way to deal with overplotting like this is to make each point slightly transparent. We can do that with the <code>alpha</code> parameter:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">treedata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">elevation</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">elevation</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<p><img src="lab02_t-tests_files/figure-html/unnamed-chunk-10-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Again, because we aren’t mapping the alpha value to any data, we include it outside of <code>aes()</code>.</p>
</div>
<div id="exercise-2" class="section level2">
<h2 class="hasAnchor">
<a href="#exercise-2" class="anchor"></a>Exercise 2</h2>
<p>The graph above is fine for a quick visualization of the data but wouldn’t be appropriate for including in publications or reports. On your own,</p>
<ol style="list-style-type: decimal">
<li><p>Improve the axis labels. This could include: title case, units, font size, etc. Run <code>?scale_y_continuous</code> and <code>?scale_x_discrete</code> if you need some help (and note the difference between these two functions!). <code>?theme</code> may also be useful</p></li>
<li><p>Manually change the color of the points (<code>?scale_color_manual</code>)</p></li>
<li><p>Instead of displaying the data using a boxplot, create histograms showing the distribution of tree densities at each elevation (<code>?geom_histogram</code>)</p></li>
</ol>
<p>As you learn about graphics functions, whether base or <code>ggplot2</code>, you will probably need to look up help for how to do certain things. Google is usually your best bet but here are a few other good references:</p>
<ul>
<li><p>The fantastic <a href="https://clauswilke.com/dataviz/">Fundamentals of Data Visualization</a> book by Claus Wilke</p></li>
<li><p>The <code>ggplot2</code> package <a href="https://ggplot2.tidyverse.org/">website</a></p></li>
<li><p>As, yes, even the base <code>R</code> <a href="https://www.r-graph-gallery.com/base-R.html">graph gallery</a></p></li>
</ul>
</div>
</div>
<div id="t-tests" class="section level1">
<h1 class="hasAnchor">
<a href="#t-tests" class="anchor"></a>t-tests</h1>
<div id="two-sample-t-test-with-equal-variances" class="section level2">
<h2 class="hasAnchor">
<a href="#two-sample-t-test-with-equal-variances" class="anchor"></a>Two-sample t-test with equal variances</h2>
<p>Back to the t-test. Remember the basic steps for performing a two-sample t-test:</p>
<div id="step-1-compute-the-t-statistic" class="section level3">
<h3 class="hasAnchor">
<a href="#step-1-compute-the-t-statistic" class="anchor"></a>Step 1: Compute the <span class="math inline">\(t\)</span> statistic:</h3>
<p><span class="math display">\[\large t = \frac{(\bar{y}_L − \bar{y}_H) − (\mu_L − \mu_H)}{\sqrt{s^2_p/n_L + s^2_p/n_H}}\]</span> where <span class="math inline">\(s^2_p\)</span> is the pooled variance</p>
<p><span class="math display">\[\large s^2_p = \frac{(n_L − 1)s^2_L + (n_H − 1)s^2_H}{n_L + n_H − 2}\]</span></p>
<div id="step-2-compare-t-statistic-to-critical-values" class="section level4">
<h4 class="hasAnchor">
<a href="#step-2-compare-t-statistic-to-critical-values" class="anchor"></a>Step 2: Compare <span class="math inline">\(t\)</span> statistic to critical values:</h4>
<ul>
<li><p>Critical values for 1-tailed test <span class="math inline">\(t_{\alpha=0.05,18} = −1.73\)</span> or <span class="math inline">\(1.73\)</span></p></li>
<li><p>Critical values for 2-tailed test <span class="math inline">\(t_{\alpha=0.05,18} = −2.10\)</span> and <span class="math inline">\(2.10\)</span></p></li>
</ul>
<p>Now let’s use <code>R</code> to run a t-test on the example data.</p>
</div>
</div>
</div>
<div id="option-1-do-it-by-hand" class="section level2">
<h2 class="hasAnchor">
<a href="#option-1-do-it-by-hand" class="anchor"></a>Option 1: Do it by hand</h2>
<div id="step-1-compute-the-t-statistic-1" class="section level4">
<h4 class="hasAnchor">
<a href="#step-1-compute-the-t-statistic-1" class="anchor"></a>Step 1: Compute the <span class="math inline">\(t\)</span> statistic:</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"treedata"</span><span class="op">)</span>

<span class="co"># Subset data</span>
<span class="va">yL</span> <span class="op">&lt;-</span> <span class="va">treedata</span><span class="op">$</span><span class="va">density</span><span class="op">[</span><span class="va">treedata</span><span class="op">$</span><span class="va">elevation</span> <span class="op">==</span> <span class="st">"Low"</span><span class="op">]</span>
<span class="va">yH</span> <span class="op">&lt;-</span> <span class="va">treedata</span><span class="op">$</span><span class="va">density</span><span class="op">[</span><span class="va">treedata</span><span class="op">$</span><span class="va">elevation</span> <span class="op">==</span> <span class="st">"High"</span><span class="op">]</span>

<span class="co"># Compute means</span>
<span class="va">mean.L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">yL</span><span class="op">)</span>
<span class="va">mean.H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">yH</span><span class="op">)</span>

<span class="co"># Compute variances</span>
<span class="va">s2.L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">yL</span><span class="op">)</span>
<span class="va">s2.H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">yH</span><span class="op">)</span>

<span class="co"># Sample sizes</span>
<span class="va">n.L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">yL</span><span class="op">)</span>
<span class="va">n.H</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">yH</span><span class="op">)</span>

<span class="co"># Pooled variance</span>
<span class="va">s2.p</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">n.L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">s2.L</span> <span class="op">+</span> <span class="op">(</span><span class="va">n.H</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">s2.H</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">n.L</span><span class="op">+</span><span class="va">n.H</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span>

<span class="co"># Pooled standard error</span>
<span class="va">SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">s2.p</span><span class="op">/</span><span class="va">n.L</span> <span class="op">+</span> <span class="va">s2.p</span><span class="op">/</span><span class="va">n.H</span><span class="op">)</span>

<span class="co"># Compute t-statistic</span>
<span class="va">t.stat</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mean.L</span> <span class="op">-</span> <span class="va">mean.H</span><span class="op">)</span> <span class="op">/</span> <span class="va">SE</span>
<span class="va">t.stat</span>
<span class="co">#&gt; [1] 14.36</span></code></pre></div>
</div>
<div id="step-2-compare-t-statistic-to-critical-values-two-tailed" class="section level4">
<h4 class="hasAnchor">
<a href="#step-2-compare-t-statistic-to-critical-values-two-tailed" class="anchor"></a>Step 2: Compare <span class="math inline">\(t\)</span> statistic to critical values (two-tailed)</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>

<span class="co">## NOTE: qt returns critical values from the t-distribution. No need to use "t tables"</span>
<span class="va">critical.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, df<span class="op">=</span><span class="va">n.L</span><span class="op">+</span><span class="va">n.H</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span>
<span class="va">critical.vals</span>
<span class="co">#&gt; [1] -2.101  2.101</span></code></pre></div>
</div>
</div>
<div id="option-2-let-r-do-all-the-work" class="section level2">
<h2 class="hasAnchor">
<a href="#option-2-let-r-do-all-the-work" class="anchor"></a>Option 2: Let R do all the work</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">yH</span>, <span class="va">yL</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>, paired <span class="op">=</span> <span class="cn">FALSE</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  yH and yL</span>
<span class="co">#&gt; t = -14, df = 18, p-value = 3e-11</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -11.858  -8.831</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x mean of y </span>
<span class="co">#&gt;     5.568    15.913</span></code></pre></div>
<hr>
<p>Make sure you set <code>var.equal=TRUE</code>. Otherwise, <code>R</code> will assume that the variances of the two populations are unequal</p>
<hr>
</div>
<div id="option-1-let-r-do-all-the-work-alternate-syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#option-1-let-r-do-all-the-work-alternate-syntax" class="anchor"></a>Option 1: Let R do all the work (alternate syntax)</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">density</span> <span class="op">~</span> <span class="va">elevation</span>, data <span class="op">=</span> <span class="va">treedata</span>, 
       var.equal <span class="op">=</span> <span class="cn">TRUE</span>, paired <span class="op">=</span> <span class="cn">FALSE</span>, 
       alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  density by elevation</span>
<span class="co">#&gt; t = 14, df = 18, p-value = 3e-11</span>
<span class="co">#&gt; alternative hypothesis: true difference in means between group Low and group High is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;   8.831 11.858</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt;  mean in group Low mean in group High </span>
<span class="co">#&gt;             15.913              5.568</span></code></pre></div>
<hr>
<p>This second option returns identical results (though note that the order of the levels has been switched. Why is that?), but it is preferred because the notation is much more similar to the notation used to fit ANOVA models</p>
<hr>
</div>
</div>
<div id="test-equality-of-variances-using-var-test" class="section level1">
<h1 class="hasAnchor">
<a href="#test-equality-of-variances-using-var-test" class="anchor"></a>Test equality of variances using <code>var.test</code>
</h1>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">yL</span>, <span class="va">yH</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  F test to compare two variances</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  yL and yH</span>
<span class="co">#&gt; F = 0.61, num df = 9, denom df = 9, p-value = 0.5</span>
<span class="co">#&gt; alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.1521 2.4653</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; ratio of variances </span>
<span class="co">#&gt;             0.6123</span></code></pre></div>
</div>
<div id="paired-t-test" class="section level1">
<h1 class="hasAnchor">
<a href="#paired-t-test" class="anchor"></a>Paired <em>t</em>-test</h1>
<div id="suppose-the-samples-are-paired" class="section level3">
<h3 class="hasAnchor">
<a href="#suppose-the-samples-are-paired" class="anchor"></a>Suppose the samples are paired</h3>
<p>The caterpillar data:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"caterpillar"</span><span class="op">)</span></code></pre></div>
</div>
<div id="for-paired-t-tests-we-want-to-know-if-the-mean-of-the-differences-differs-from-zero" class="section level3">
<h3 class="hasAnchor">
<a href="#for-paired-t-tests-we-want-to-know-if-the-mean-of-the-differences-differs-from-zero" class="anchor"></a>For paired <em>t</em>-tests, we want to know if the mean of the differences differs from zero</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">caterpillar</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">caterpillar</span>, diff <span class="op">=</span> <span class="va">untreated</span> <span class="op">-</span> <span class="va">treated</span><span class="op">)</span>
<span class="va">caterpillar</span><span class="op">$</span><span class="va">diff</span>
<span class="co">#&gt;  [1]  4  0  5 -1  2 -2  1  2  3  4  1 -1</span>

<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">caterpillar</span><span class="op">$</span><span class="va">diff</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.5</span></code></pre></div>
</div>
<div id="is-the-mean-different-from-zero" class="section level2">
<h2 class="hasAnchor">
<a href="#is-the-mean-different-from-zero" class="anchor"></a>Is the mean different from zero?</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">caterpillar</span>, <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></code></pre></div>
<p><img src="lab02_t-tests_files/figure-html/unnamed-chunk-18-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div id="paired-t-test-1" class="section level2">
<h2 class="hasAnchor">
<a href="#paired-t-test-1" class="anchor"></a>Paired <em>t</em>-test</h2>
<p><strong>Recall</strong>: Paired <em>t</em>-test is the same as a one-sample t-test on the differences. The hypothesis in the caterpillar example is one-tailed:</p>
<ul>
<li><p><span class="math inline">\(\large H_0 : \mu_d = 0\)</span></p></li>
<li><p><span class="math inline">\(\large H_A : \mu_d &gt; 0\)</span></p></li>
</ul>
<div id="step-1--calculate-the-standard-deviation-of-the-differences" class="section level4">
<h4 class="hasAnchor">
<a href="#step-1--calculate-the-standard-deviation-of-the-differences" class="anchor"></a>Step 1. Calculate the standard deviation of the differences</h4>
<p><span class="math display">\[\large s_d = \sqrt{\frac{1}{n-1}\sum_{i=1}^n(y_i - \bar{y})^2}\]</span></p>
</div>
<div id="step-2--calculate-the-test-statistic" class="section level4">
<h4 class="hasAnchor">
<a href="#step-2--calculate-the-test-statistic" class="anchor"></a>Step 2. Calculate the test statistic</h4>
<p><span class="math display">\[\large t = \frac{\bar{y}-0}{s_d/\sqrt{n}}\]</span></p>
</div>
<div id="step-3--compare-to-critical-value" class="section level4">
<h4 class="hasAnchor">
<a href="#step-3--compare-to-critical-value" class="anchor"></a>Step 3. Compare to critical value</h4>
</div>
</div>
</div>
<div id="assignment" class="section level1">
<h1 class="hasAnchor">
<a href="#assignment" class="anchor"></a>Assignment</h1>
<p>Create an R Markdown file to do the following:</p>
<ol style="list-style-type: decimal">
<li>Create an <code>R</code> chunk to load the caterpillar data using:</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"caterpillar"</span><span class="op">)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><p>Make a figure to show the caterpillar counts on treated and untreated plots. If you plan to use <code>ggplot2</code>, you may want to learn about the <code>pivot_longer()</code> function from the <code>tidyr</code> package to reformat the data frame in the “long” format, which will make the plotting code easier.</p></li>
<li><p>Create a header called “Hypotheses” and under this header, in plain English indicate what the null and alternative hypotheses are for the paired <em>t</em>-test. Also use R Markdown’s equation features to write these hypotheses using mathematical notation</p></li>
<li><p>Create a header called “Paired <em>t</em>-test by hand”. Under this header, do a paired <em>t</em>-test on the caterpillar data without using the <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> function. Use only the functions <code>mean</code>, <code>sd</code>, and possibly <code>length</code>. Be sure to <strong>annotate your code</strong> (either within the <code>R</code> chunk using <code>#</code> or as plain text within the R Markdown file) and <strong>state the decision</strong> (reject or accept the null) based on your results.</p></li>
<li>
<p>Create a header called “Paired <em>t</em>-test in R”. Under this header, do the paired <em>t</em>-test again, but this time using the <code>t.test</code> function.</p>
<ul>
<li><p>You will need to use the paired argument when using the <code>t.test</code> function</p></li>
<li><p>Assume variances are equal</p></li>
</ul>
</li>
<li><p>Create a header called “Unpaired <em>t</em>-test in R”. Under this header, do a standard (unpaired) two-sample <em>t</em>-test using the <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> function</p></li>
<li><p>Add a section at the end of your file called “Discussion” and explain why the results differ between the paired and unpaired analysis</p></li>
</ol>
<p>A few things to remember when creating the assignment:</p>
<ul>
<li><p>Be sure the output type is set to: <code>output: html_document</code></p></li>
<li><p>Title the document: <code>title: "Lab 2 assignment"</code></p></li>
<li><p>Be sure to include your first and last name in the <code>author</code> section</p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code> chunks so we can see both your code and the output</p></li>
<li><p>Regularly knit the document as you work to check for errors</p></li>
<li><p>See the R Markdown reference sheet for help with creating <code>R</code> chunks, equations, tables, etc.</p></li>
</ul>
<div id="upload-the--rmd-and--html-files-to-elc-before-next-weeks-lab" class="section level3">
<h3 class="hasAnchor">
<a href="#upload-the--rmd-and--html-files-to-elc-before-next-weeks-lab" class="anchor"></a>Upload the <code>.Rmd</code> and <code>.html</code> files to ELC before next week’s lab</h3>
</div>
<div id="read-pp--127131-in-introductory-statistics-with-r" class="section level2">
<h2 class="hasAnchor">
<a href="#read-pp--127131-in-introductory-statistics-with-r" class="anchor"></a>Read pp. 127–131 in “Introductory Statistics with R”</h2>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
