<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>LECTURE 10: confidence intervals (again)</title>
    <meta charset="utf-8" />
    <meta name="author" content="   Fall 2022" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="FANR6750.css" type="text/css" />
    <link rel="stylesheet" href="FANR6750-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# LECTURE 10: confidence intervals (again)
]
.subtitle[
## FANR 6750 (Experimental design)
]
.author[
### <br/><br/><br/>Fall 2022
]

---




# outline 

&lt;br/&gt;

1) Motivation

&lt;br/&gt;

--

2) Example

&lt;br/&gt;

--

3) Graphical displays


---
class: inverse

# motivation

&lt;br/&gt;

Thus far, we have approached ANOVA from a statistical hypothesis testing standpoint only.  

&lt;br/&gt;

--
This approach and the use of statistical significance alone has been criticized because:  

--
- Null hypotheses are almost always known to be false *a priori*  

--
- `\(\alpha\)` levels are arbitrary  

--
- Statistical significance is based on sample size  

--
- Statistical and biological significance are easily confused  

&lt;br/&gt;
--

Practitioners often are not interested in whether or not a null hypothesis can be rejected, but rather what the magnitude of the treatment effect is  

---
# parameter estimation

Often an investigator wants to obtain one or more estimates of parameters after (or as part of) an analysis of variance

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Parameter &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Description &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(\mu\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Overall mean &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(\mu + \alpha_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; The \(i\)th treatment mean &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(\alpha_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; The \(i\)th treatment effect &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(\mu_i - \mu_{i^\prime}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Difference between 2 means &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(\sum_i a_i \mu_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Some linear combination of parameters &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
# confidence intervals

#### For each estimate, we often want a confidence interval to quantify uncertainty 

&lt;br/&gt;

--

#### What is a confidence interval? `\(^*\)`

&gt; An interval [a,b] that is likely to include the true parameter of interest  

--

&gt; If we calculated the x% confidence interval on an infinite number of samples from the population, x% of the intervals would contain the true parameter value

&lt;br/&gt;

--

#### In the context of ANOVA, the formula is:

`$$\large CI_{1-\alpha} = point\; estimate \pm t_{\alpha/2,a(n-1)}\timesSE$$` 
???

`\(^*\)`Do you find confidence intervals confusing? If so, you are not alone. Here a few resources to help:

- A [nice webapp](https://www.zoology.ubc.ca/~whitlock/Kingfisher/CIMean.htm) for simulating samples and confidence intervals  

- Tthis blog](https://econometricsense.blogspot.com/2018/12/thinking-about-confidence-intervals.html) does a nice job explaining that it's the interval, not the true value, that is the random variable. That is, the true parameter value is a fixed point. But every time we collect a sample, the bounds of the confidence interval we calculate will change 

- [Another metaphor](https://medium.com/@EpiEllie/having-confidence-in-confidence-intervals-8f881712d837) for thinking about what a confidence interval is

---
# standard errors

#### The standard error (SE) is the standard deviation of the sampling distribution of a statistic  
&lt;br/&gt;

--

#### We usually estimate the SE using a single sample of data  

&lt;br/&gt;

--

#### But the appropriate equation for the SE depends on the statistic of interest  

---
# standard errors

&lt;br/&gt;

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Parameter &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Symbol &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Point &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; SE &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Mean &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\mu\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\bar{y}.\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sqrt{MSe/N}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Treatment mean &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\mu_i = \mu + \alpha_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\bar{y}_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sqrt{MSe/n_i}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Difference in means &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\mu_i - \mu_{i^\prime}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\bar{y}_i - \bar{y}_{i^\prime}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sqrt{MSe(N-n_i)/n_i N}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Linear Combination &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sum_i a_i \mu_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sum_i a_i \bar{y}_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sqrt{MSe \sum_i a_i^2/n_i}\) &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

#### Note: Confidence intervals based on these SEs are not adjusted for multiple comparisons  

---
# mussel data example

&lt;table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;border-bottom: 0;"&gt;
 &lt;thead&gt;
&lt;tr&gt;&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Watershed&lt;/div&gt;&lt;/th&gt;&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Twelvemile &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Chattooga &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Keowee &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Coneross &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 28 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 14 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 25 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 20 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 11 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 17 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 16 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 17 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 26 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 27 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 15 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;
&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;&lt;span style="font-style: italic;"&gt;Note: &lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; MSe = 13.5&lt;/td&gt;&lt;/tr&gt;
&lt;/tfoot&gt;
&lt;/table&gt;

--

#### What types of confidence intervals can we compute?

---
# displaying confidence intervals

&lt;img src="10_estimation_files/figure-html/unnamed-chunk-4-1.png" width="648" style="display: block; margin: auto;" /&gt;

---
# displaying confidence intervals

&lt;img src="10_estimation_files/figure-html/unnamed-chunk-5-1.png" width="648" style="display: block; margin: auto;" /&gt;

---
# displaying confidence intervals

&lt;img src="10_estimation_files/figure-html/unnamed-chunk-6-1.png" width="648" style="display: block; margin: auto;" /&gt;

---
# displaying confidence intervals

&lt;img src="10_estimation_files/figure-html/unnamed-chunk-7-1.png" width="648" style="display: block; margin: auto;" /&gt;

---
# summary

- Confidence intervals allow one to focus on effect sizes and statistical significance at the same time  

&lt;br/&gt;

--

- If `\(p &lt; 0.05\)`, a 95% CI will not include 0 and vice versa  

&lt;br/&gt;

--

- If the CIs of two means do not overlap, the difference is statistically different. However, if the CIs of two means overlap, it does not necessarily indicate that there is no difference  

&lt;br/&gt;

--

- It is better to assess if the CI of the difference in means includes 0
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
