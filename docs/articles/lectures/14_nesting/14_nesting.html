<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>LECTURE 14: nested designs</title>
    <meta charset="utf-8" />
    <meta name="author" content="   Fall 2022" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="FANR6750.css" type="text/css" />
    <link rel="stylesheet" href="FANR6750-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# LECTURE 14: nested designs
]
.subtitle[
## FANR 6750 (Experimental design)
]
.author[
### <br/><br/><br/>Fall 2022
]

---




# outline 

1) Motivation

&lt;br/&gt;

--

2) Model

&lt;br/&gt;

--

3) Procedure

&lt;br/&gt;

--

4) Example


---
# motivation

#### Often, the response variable is measured numerous times within the experimental unit  

--

For example, we might apply a pesticide for gypsy moth control to 200 ha plots. We want to see if there are fewer gypsy moths on treated plots compared with untreated plots, but we can't sample the whole plot, so we work with four subplots of 0.04 ha each. The 3 plots below represent one replicate of each of the treatments  

&lt;img src="figs/gypsymoth.png" width="80%" height="80%" style="display: block; margin: auto;" /&gt;

---
# terminology

There are numerous terms for subplots. Sometimes they are called subsamples. In experimental design terminology, we refer to the 0.04-ha subplots as **subunits**, and the 200-ha plots as
**whole units**, and the design in general is referred to as a **nested design**

&lt;img src="figs/gypsymoth.png" width="80%" height="80%" style="display: block; margin: auto;" /&gt;



---
# other examples of nested designs

&lt;br/&gt;

&lt;table class="table" style="font-size: 14px; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; Response &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Whole unit &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Subunit &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; Scope of inference &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Fish Abundance &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; River &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Reach &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; All rivers in study area &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Lead (Pb) levels &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Individual &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Blood sample &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Population &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tree height &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Stand &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Quadrat &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; All stands in study region &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
class: inverse, middle, center

# model

---
# data structure for nested design

&lt;table class="table table-condensed" style="font-size: 14px; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
&lt;tr&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Observation (k)&lt;/div&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Experimental unit within observation (j)&lt;/div&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Treatment (i)&lt;/div&gt;&lt;/th&gt;
&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Bt &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Dimilin &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Control &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{111}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{211}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{311}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{112}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{212}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{312}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{113}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{213}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{313}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{121}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{221}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{321}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{122}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{222}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{322}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{123}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{223}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(y_{323}\) &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# model

`$$\Large y_{ijk} = \mu + \alpha_i + \beta_{ij} + \epsilon_{ijk}$$`

`$$\large \beta_{ij} \sim normal(0, \sigma^2_B)$$`

`$$\large \epsilon_{ijk} \sim normal(0, \sigma^2)$$`

--

`$$i = 1, ..., a \;(treatment \;levels)$$`
`$$j = 1, ..., b \;(whole \; units)$$`
`$$k = 1, ..., n \;(subunits)$$`
--

- `\(\mu =\)` grand mean  

- `\(\alpha_i =\)` effect of the `\(i\)`th treatment  

- `\(\beta_{ij} =\)` **random** effect of the `\(ij\)`th whole unit  

- `\(\epsilon_{ijk} =\)` residual, unexplained variation

---
# hypotheses

#### Main hypothesis of interest

`$$\large H_0 : \alpha_1 = \alpha_2 = ... = \alpha_a = 0$$`

`$$\large H_a : At \;least \;one \;inequality$$`

#### Secondary hypothesis

`$$\large H_0 : \sigma^2_B = 0$$`

`$$\large H_a : \sigma^2_B &gt; 0$$`
---
class: inverse, middle, center

# procedure

---
# anova table

&lt;br/&gt;

&lt;table class="table table-condensed" style="font-size: 18px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Source &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; df &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; SS &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Among treatment &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(a-1\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(bn \sum_i (\bar{y}_{i} - \bar{y})^2\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Among whole units within treatments &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(a(b-1)\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(n \sum_i \sum_j (\bar{y}_{ij} - \bar{y}_{i})^2\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Among subunits within whole units &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(ab(n-1)\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sum_i \sum_j \sum_k (y_{ijk} - \bar{y}_{ij})^2\) &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

#### What are the associated mean squares and F statistics?

---
# anova table

&lt;br/&gt;

&lt;table class="table table-condensed" style="font-size: 18px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Source &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; MS &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; F &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Among treatment &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_a}{a-1}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{MS_a}{MS_b}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Among whole units within treatments &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_b}{a(b-1)}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{MS_b}{MS_e}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Among subunits within whole units &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_e}{ab(n-1)}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
class: center, middle

## Consequences of using incorrect df?

---
class: center, middle, inverse

## Pseudoreplication!!!!

--
#### Using subsamples as the experimental unit in an F-test means that you are using the incorrect error degrees of freedom

---
# estimation

#### Standard error for the difference of two means

`$$\Large SE = \frac{2MS_b}{bn}$$`

--

#### Confidence intervals


`$$\Large CI = Estimate \pm t_{1-\alpha/2,a(b-1)} \times SE$$`

&lt;br/&gt;

--

#### Review pages 300-302 of Dowdy et al. for background

---
# why use a nested design?

#### In the subsampling scenario, the only thing a nested design is good for, of and by itself, is testing whether or not there is signficant variation among the experimental units within a treatment level  

--

#### Additional subsamples will not add any power to your design; they only allow you to estimate the response variable in each experimental unit better  

--

#### The F-statistic you get for the treatment effect above is identical to what you would get if you used the mean of the response variable for each experimental unit as the data  

---
class: inverse, center, middle

# example

---
# example

.pull-left[
&lt;table class="table table-condensed" style="font-size: 8px; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
&lt;tr&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Observation (k)&lt;/div&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Experimental unit within observation (j)&lt;/div&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Treatment (i)&lt;/div&gt;&lt;/th&gt;
&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Bt &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Dimilin &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Control &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 16.0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 12.3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 18.5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 16.0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13.0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 18.0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 15.8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 12.7 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 18.4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 14.2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 12.0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 18.1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13.9 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 14.0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 18.7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 14.2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13.1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 19.0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13.5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13.5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 18.8 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13.4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13.4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 18.5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 14.0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13.0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 19.5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13.1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 12.4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 17.5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13.5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 12.8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 19.1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 15.4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13.8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 20.9 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

--

.pull-right[
`$$\large \bar{y} = 15.39$$` 

`$$\large \bar{y}_i = 14.42, 13.00, 18.75$$` 
`$$\begin{aligned}
  \bar{y}_{ij} = 15.50, 13.75, 14.00, \\
  12.50, 13.50, 13.00, \\
  18.25, 18.75, 19.25
\end{aligned}$$`

]
---
# connections to what's ahead

&lt;br/&gt;

#### Later, we will deal with designs where one effect is nested within another, and the experimental units are actually at two different scales (a split-plot design)

&lt;br/&gt;

--

#### Also, we will consider designs where the whole unit is sampled repeatedly through time, and the time factor will be another type of subunit (a repeated measures design)  


---
# summary

- Nested designs involve multiple measurements of the response variable at each experimental unit

--

- This is usually done out of necessity because it is too diffcult to thoroughly measure the response variable at the level of the whole unit  

--

- Increasing `\(\large n\)`, the number of subunits per whole unit, does not increase power. It only allows you to estimate the response variable better within each experimental unit  

--

- Pseudoreplication occurs when `\(MS_e\)` is used in the denominator of the *F* test for the treatment effect  


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
