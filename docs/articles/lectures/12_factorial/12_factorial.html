<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>LECTURE 12: factorial designs</title>
    <meta charset="utf-8" />
    <meta name="author" content="   Fall 2021" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="FANR6750.css" type="text/css" />
    <link rel="stylesheet" href="FANR6750-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# LECTURE 12: factorial designs
## FANR 6750 (Experimental design)
### <br/><br/><br/>Fall 2021

---




# outline 

1) `\(\large a \times b\)` design

&lt;br/&gt;

--

2) Model

&lt;br/&gt;

--

3) Procedure

&lt;br/&gt;

--

4) Example

&lt;br/&gt;

--

5) `\(\large a \times b \times c\)` design

---
# factorial designs

&lt;br/&gt;

#### Often an investigator is interested in the combined effect of two types of treatments  

&lt;br/&gt;

--

#### For example, a study might examine the effects of **predation** and **food supplementation** on *Microtus californicus* abundance  

&lt;br/&gt;

--

#### We "seed" each enclosure with 10 *Microtus* and record the number of voles present after a specified period of time.

---
# *microtus californicus*

&lt;img src="https://upload.wikimedia.org/wikipedia/commons/d/d4/California_Vole_%28Microtus_californicus%29.jpg" width="90%" height="90%" style="display: block; margin: auto;" /&gt;


---
# factorial designs

&lt;img src="12_factorial_files/figure-html/unnamed-chunk-2-1.png" width="648" style="display: block; margin: auto;" /&gt;


---
# factorial designs

- This design differs from blocking designs in that neither of the treatments is considered extraneous to the experimental question (i.e., what controls numbers of voles?)  

--

- In this case, the experimental unit is an enclosure, and multiple enclosures are represented by and allocated to each combination of the two treatments  

--

- The treatment variables are called **factors** or main effects, and the different treatments within factors are called **levels**  

--

- The design is called a factorial design. Here, because there are two factors (predation, food), we will represent them as *A* and *B* and call this an `\(\large a \times b\)` factorial design  

--

- Because there are `\(\large a = 2\)` levels of predation and `\(\large b = 4\)` levels of food supplementation, this is a `\(\large 2 \times 4\)` factorial design  

---
# interactions

&lt;br/&gt;

- We are also usually interested in looking at **interactions**, which is one of the most important notions in ANOVA and experimental design  

--

- An interaction is an additional effect due to the particular combination of the two levels  

--

- If an interaction is present, it means that **the effect of one factor depends on the other factor**  

--

- For example, the effect of predation might depend on the amount of food supplementation  


---
# interactions

Graphically, interactions are indicated by significant departure from parallelism

&lt;img src="12_factorial_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;" /&gt;



---
## DATA STRUCTURE FOR `\(\large a \times b\)` FACTORIAL DESIGN

&lt;table class="table table-condensed" style="font-size: 14px; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
&lt;tr&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Replicate (k)&lt;/div&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Predation (j)&lt;/div&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Food supplementation (i)&lt;/div&gt;&lt;/th&gt;
&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; 0 &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; 1 &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; 2 &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; 3 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Without &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{111}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{211}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{311}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{411}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Without &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{112}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{212}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{312}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{412}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; With &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{121}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{221}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{321}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{421}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; With &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{122}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{222}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{322}\) &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; \(y_{422}\) &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

Notice that the subscript `\(k\)` represents the replicate for each combination of factors A and B, and there must be replication for each combination of factors

--

Also notice that this design is balanced, i.e. there is the same number of replicates (two) for each combination of factors.


---
# model

`$$\Large y_{ijk} = \mu + \alpha_i + \beta_j + \alpha \beta_{ij} + \epsilon_{ijk}$$`

`$$\large \epsilon_{ijk} \sim normal(0, \sigma^2)$$`

`$$i = 1, ..., a \;(levels \;of \;factor\;A)$$`
`$$j = 1, ..., b \;(levels \;of \;factor\;B)$$`
`$$k = 1, ..., n \;(replicates \;of \;each \;combination \;of \;A \;and \;B)$$`

- `\(\mu =\)` grand mean  

- `\(\alpha_i =\)` effect of the `\(i\)`th level of food supplementation  

- `\(\beta_j =\)` effect of the `\(j\)`th level of predator exclusion  

- `\(\alpha \beta_{ij} =\)` effect of interaction of `\(i\)`th level of food and `\(j\)`th level of predation  

- `\(\epsilon_{ijk} =\)` residual, unexplained variation

---
# hypotheses

#### Factor A

`$$H_0 : \alpha_1 = \alpha_2 = ... = \alpha_a = 0$$`

`$$H_a : At \;least \;one \;inequality$$`

#### Factor B

`$$H_0 : \beta_1 = \beta_2 = ...  = \beta_b = 0$$`

`$$H_a : At \;least \;one \;inequality$$`
--

#### Interaction of factors A &amp; B

`$$H_0 : \alpha\beta_1 = \alpha\beta_2 = ... = \alpha\beta_{ij} = 0 \;for \;all \;ij$$`

`$$H_a : At \;least \;one \;inequality$$`

--
Technically, we could treat each of the effects as fixed or random, although it is much more common to use fixed effects in factorial designs

---
# anova table

&lt;br/&gt;

&lt;table class="table table-condensed" style="font-size: 18px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Source &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; df &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; SS &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Factor A &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(a-1\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(bn \sum_i (\bar{y}_{i..} - \bar{y}_{...})^2\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Factor B &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(b-1\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(an \sum_j (\bar{y}_{.j.} - \bar{y}_{...})^2\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; A x B &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \((a-1)(b-1)\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(n \sum_i \sum_j (\bar{y}_{ij.} - \bar{y}_{i..} - \bar{y}_{.j.} + \bar{y}_{...})^2\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Error &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(ab(n-1)\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sum_i \sum_j \sum_k (y_{ijk} - \bar{y}_{ij.})^2\) &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

#### What are the associated mean squares and F statistics?

---
# more on interactions

#### If an interaction is significant, then the effect of one factor depends on the other factor  

--

#### Thus, if an interaction is significant, then usually it is ill-advised to further investigate main effects alone (such as with multiple comparison procedures) without taking the other factor into account  

--

#### The way that you do this is to perform a multiple comparison test for one factor at each level of the other factor, and vice versa  

--

#### This is easily performed in `R` as we will see in lab  


---
class: inverse, center, middle

# example

---
# analysis of (fake) *microtus* data

#### Data are voles per enclosure

&lt;table class="table" style="font-size: 14px; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
&lt;tr&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Replicate (k)&lt;/div&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Predation (j)&lt;/div&gt;&lt;/th&gt;
&lt;th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3"&gt;&lt;div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; "&gt;Food supplementation (i)&lt;/div&gt;&lt;/th&gt;
&lt;/tr&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; 0 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; 1 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; 2 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; With &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; With &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; With &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 21 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; With &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 24 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Without &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 42 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Without &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 40 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Without &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 36 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 44 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Without &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 40 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 42 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# analysis of (fake) *microtus* data



```r
data("microtusData")
microtusData$food &lt;- as.factor(microtusData$food)
aov1 &lt;- aov(voles ~ food*predators, data = microtusData)
summary(aov1)
```

```
##                Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## food            2   1337     669    40.6 2.1e-07 ***
## predators       1    975     975    59.2 4.3e-07 ***
## food:predators  2    518     259    15.7 0.00011 ***
## Residuals      18    297      16                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---
# analysis of (fake) *microtus* data



```r
newDat &lt;- data.frame(food = rep(c("0", "1", "2"), 2),
                     predators = rep(c("Present", "Absent"), 3))
pred &lt;- predict(aov1, newdata = newDat, se.fit = TRUE, 
                interval = "confidence", level = 0.95)

pred$fit
```

```
##     fit    lwr   upr
## 1 11.00  6.735 15.27
## 2 31.50 27.235 35.77
## 3 17.00 12.735 21.27
## 4 13.50  9.235 17.77
## 5 20.75 16.485 25.02
## 6 42.00 37.735 46.27
```

---
# analysis of (fake) *microtus* data

&lt;img src="12_factorial_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;" /&gt;

---
## `\(\large a \times b \times c\)` DESIGN

- The `\(\large a \times b\)` factorial design can be extended to three or more factors  

--

- Development of Sums of Squares, degrees of freedom, etc. are natural extensions of what we have learned before, but we will not cover them in this course. See Dowdy et al. if you are interested in the details  

--

- If the three-way interaction is significant, then the effect of one factor is dependent upon the particular levels of both of the other factors  

--

- In practice, one could try to tease apart these relationships as we discussed previously for the two-way design. However, interpretation of these results gets confusing  

--

- A much more effective approach is to present the results graphically (means and standard errors or confidence intervals) as we did before with the vole example. This will necessitate more than one graph  

---
# army ants

Roberts et al. (2000)\* followed randomly selected army ant swarms of two species (*Eciton burchellii* and *Labidus praedator*) in two habitats (shade coffee plantations and primary forest) in two seasons (dry and wet) in western Panama  

--

Of the two species, *E. burchellii* is larger and spends most of its time above ground in bivouacs or swarming, whereas *L. praedator* is smaller and spends much of its time below ground, although it also swarms above ground. The response variables were number of birds attending the swarms (to capture flushed arthropods) and the number of bird species attending the swarms  

--

This was set up as a three-way factorial design  

???

`\(^*\)`Roberts, D. L., Cooper, R. J., &amp; Petit, L. J. (2000). Flock characteristics of ant‚Äêfollowing birds in premontane moist forest and coffee agroecosystems. *Ecological Applications*, 10(5), 1414-1425.

---
# army ants

.pull-left[

&lt;br/&gt;

&lt;img src="https://upload.wikimedia.org/wikipedia/commons/d/d3/Eciton_burchellii_army_ants.jpg" style="display: block; margin: auto;" /&gt;

]

.pull-right[

&lt;img src="https://upload.wikimedia.org/wikipedia/commons/7/74/Ocelated_Antbird_%2839995295545%29.jpg" style="display: block; margin: auto;" /&gt;

]

---
# army ants

.pull-left[

&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/iDIyGSOdTys" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;

]

.pull-right[

&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/UozWJTuhbMQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;


]

---
# army ants

&lt;br/&gt;

&lt;img src="figs/Image 7-6-21 at 11.15 AM.png" width="353" style="display: block; margin: auto;" /&gt;

---
# army ants

The three-way interaction was significant for both richness ( `\(F_{1,133} = 6.05\)`, `\(P = 0.02\)`) and abundance ( `\(F_{1, 133} = 7.19\)`, `\(P = 0.008\)`)  

--

In the dry season, there were more birds in the forest than in coffee at *L. praedator* swarms, but not at *E. burchelli* swarms  

--

In the change to wet season in the spring, which also corresponded to a time when neotropical migrants left to migrate north, birds declined at all swarms except *E. burchelli* swarms in forest, where there were more obligate ant-following birds that tracked the locations of this larger, above-ground species



---
# summary

- Factorial designs let you test the effects of &gt; 1 treatment variable

--

- It's important to always assess the interaction first, before assessing main effects  

--

- If the interaction is significant, then the effect of one factor depends on the other, so they can't be interpreted in isolation  

--

- Factorial designs are extremely powerful but hard to pull off when there are more than 2 factors (with many levels per factor)  

--

- But you should try anyway!
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
