<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>LECTURE 14: split-plot designs</title>
    <meta charset="utf-8" />
    <meta name="author" content="   Fall 2021" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="FANR6750.css" type="text/css" />
    <link rel="stylesheet" href="FANR6750-fonts.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# LECTURE 14: split-plot designs
## FANR 6750 (Experimental design)
### <br/><br/><br/>Fall 2021

---




# outline 

1) Motivation

&lt;br/&gt;

--

2) Model

&lt;br/&gt;

--

3) Procedure

&lt;br/&gt;

--

4) Example


---
# motivation

#### Suppose we are interested in 2 factors, one with 3 levels and the other with 4, that we would apply to 1-ha plots of land. Then there would be 12 treatment level combinations in a 2-way factorial design. We would then randomly allocate units to the different combinations. With replication (say, in blocks) this is a large effort  


&lt;img src="figs/factorial.png" width="80%" height="80%" style="display: block; margin: auto;" /&gt;

---
# another approach

#### If factor B can be applied at a smaller scale, then all levels of B can be randomly applied to subunits within each level of A (whole units). Because the whole unit is split into subunits, which are randomly allocated to various treatment levels, the resulting design is called a **split-plot design**

&lt;img src="figs/splitplot.png" width="40%" height="40%" style="display: block; margin: auto;" /&gt;

---
# key points


### A standard split-plot design involves the following:  

--

- We apply two (or more) treatments to two types of experimental units: whole-units and sub-units  

&lt;br/&gt;

--

- Whole units are arranged in blocks to account for extraneous sources of variation  

&lt;br/&gt;

--

- We're interested in the effects of both treatments. Interactions can be tested too, but we are usually not interested in interactions involving the block  

---
# why?


### Why use a split-plot design instead of a factorial design?  

&lt;br/&gt;

--

1) Sometimes the different factors have to be applied at different scales (e.g., aerial application of pesticides)  

&lt;br/&gt;

--

2) Saves money, space, etc.  


---
class: inverse, middle, center

# model

---
# model

`$$\large y_{ijk} = \mu + \alpha_i + \beta_j + \alpha \beta_{ij} + \gamma_k + \delta_{ik} + \epsilon_{ijk}$$`

--

`$$i = 1, ..., a \;(whole-unit \;treatment \;levels)$$`
`$$j = 1, ..., b \;(subunit \; treatment\;levels)$$`
`$$k = 1, ..., c \;(blocks)$$`
--

- `\(\mu =\)` grand mean  

- `\(\alpha_i =\)` effect of the `\(i\)`th level of factor *A*, the whole unit treatment  

- `\(\beta_{j} =\)` effect of the `\(j\)`th level of factor *B*, the subunit treatment  

- `\(\alpha \beta_{ij} =\)` interaction between `\(i\)`th level of factor *A* and `\(j\)`th level of factor *B*  

- `\(\gamma_k =\)` `\(k\)`th block effect  

- `\(\delta_{ik} =\)` whole-unit effect  

- `\(\epsilon_{ijk} =\)` residual, unexplained variation

---
# model

`$$\large y_{ijk} = \mu + \alpha_i + \beta_j + \alpha \beta_{ij} + \gamma_k + \delta_{ik} + \epsilon_{ijk}$$`

Because we want our inferences to apply to all whole units, `\(\delta_{ik}\)` is random. Specifically:  

--

`$$\large \delta_{ik} \sim normal(0, \sigma^2_D)$$`
--

We might view block as random too:

`$$\large \gamma_k \sim normal(0, \sigma^2_C)$$`


--
And as always,

`$$\large \epsilon_{ijk} \sim normal(0, \sigma^2)$$`

&lt;br/&gt;

--

All other effects in the model are fixed effects  

---
# hypotheses

#### Main hypothesis of interest

`$$H_0 : \alpha_1 = \alpha_2 = ... = \alpha_a = 0$$`

`$$H_a : At \;least \;one \;inequality$$`
`$$H_0 : \beta_1 = \beta_2 = ... = \beta_b = 0$$`

`$$H_a : At \;least \;one \;inequality$$`

`$$H_0 : \alpha \beta_{ij} = 0 \; for \; all \; i \; and \; all \; j$$`

`$$H_a : At \;least \;one \;inequality$$`

#### Secondary hypothesis

`$$H_0 : \sigma^2_{D/C} = 0$$`

`$$H_a : \sigma^2_{D/C} &gt; 0$$`

---
class: inverse, middle, center

# procedure

---
# anova table

&lt;br/&gt;

#### In setting up the ANOVA table for the split-plot design, I like to think of the design having a whole-unit part and a subunit part, each with its own design.


---
# anova table

First, the whole-unit part. Does it look familiar?

&lt;table class="table table-condensed" style="font-size: 13px; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Source &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; df &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; SS &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; MS &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; F &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;font-weight: bold;text-align: left;font-size: 15px;"&gt; Whole units &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; Factor A &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(a-1\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(SS_a\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_a}{a-1}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{MS_a}{MS_{WUR}}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; Block &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(c-1\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(SS_c\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_c}{c-1}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{MS_c}{MS_{WUR}}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; Whole unit remainder &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \((a-1)(c-1)\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(SS_{WUR}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_{WUR}}{(a-1)(c-1)}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# anova table

&lt;table class="table table-condensed" style="font-size: 13px; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; Source &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; df &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; SS &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; MS &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; F &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;font-weight: bold;text-align: left;font-size: 15px;"&gt; Whole units &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; Factor A &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(a-1\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(SS_a\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_a}{a-1}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{MS_a}{MS_{WUR}}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; Block &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(c-1\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(SS_c\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_c}{c-1}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{MS_c}{MS_{WUR}}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; Whole unit remainder &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \((a-1)(c-1)\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(SS_{WUR}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_{WUR}}{(a-1)(c-1)}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;table class="table table-condensed" style="font-size: 13px; margin-left: auto; margin-right: auto;"&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;font-weight: bold;text-align: left;font-size: 15px;"&gt; Subunits &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;font-weight: bold;text-align: left;font-size: 15px;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; Factor B &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(b-1\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(SS_b\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_b}{b-1}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{MS_b}{MS_{e}}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; Interaction &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \((a-1)(b-1)\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(SS_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_i}{(a-1)(b-1)}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{MS_i}{MS_{e}}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; Subunit remainder &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(a(b-1)(c-1)\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(SS_{e}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{SS_{e}}{a(b-1)(c-1)}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# estimation

&lt;table class="table table-condensed" style="font-size: 18px; width: auto !important; margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Difference between &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; SE &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; df for t &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Two overall A means &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sqrt{\frac{2MS_{WUR}}{bc}}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \((a-1)(c-1)\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Two overall B means &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sqrt{\frac{2MS_e}{ac}}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(a(b-1)(c-1)\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Two B means at same A level &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sqrt{\frac{2MS_e}{c}}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(a(b-1)(c-1)\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Two A means at same B level or different B levels &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\sqrt{\frac{2[(b-1)MS_e + MS_{WUR}]}{bc}}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; see below &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

--

`$$\large t^* = \frac{(b-1)MS_e t_{\alpha,a(b-1)(c-1)}+MS_{WUR}t_{\alpha,(a-1)(c-1)}}{(b-1)MS_e+MS_{WUR}}$$`

---
class: inverse, center, middle

# example

---
# example

It's easy to understand the concept of split plots when dealing with plots of land, but nested effects arise in all kinds of settings  

--

Consider a food scientist who wants to study the effects of tenderizer and length of cooking time on meat. Six beef carcasses are obtained at random from a meat packaging plant. From the same section on each carcass, three rolled roasts are prepared as nearly alike as possible. Each of the roasts is assigned at random to one of three tenderizing treatments of particular interest: control, vinegar marinade, or papain marinade  

--

After treatment, a coring device is used to make four cores of meat near the center of each roast. The cores, are left in place, and the three roasts from the same carcass are placed together in a oven and allowed to cook. After 30 minutes, one of the cores is taken at random from each roast, another drawn randomly after 36 minutes, a third at 42 minutes, and the final at 48 minutes  

--

After cooling, the cores are measured for tenderness using the Warner-Bratzler device. The response variable is the WB score for each core 

---
# example

&lt;img src="figs/carcass.png" width="90%" height="90%" style="display: block; margin: auto;" /&gt;

--

What is the whole-unit here? The subunit? Which factors are associated with each (i.e., the whole-unit factor and the subunit factor)? What are the blocks? Which factors are xed versus random?  

---
# example

&lt;img src="figs/carcass_table.png" width="1166" style="display: block; margin: auto;" /&gt;

---
# nested and crossed designs

&lt;br/&gt;

#### A split-plot design without the blocking variable is called a nested and crossed design  

&lt;br/&gt;

--

#### These designs will provide a jumping-off point for repeated measures  

---
# summary

&lt;br/&gt;

- A split-plot design is efficient when one treatment effect can be nested within another  

&lt;br/&gt;

--

- Factor *A* is applied to whole units and Factor *B* is applied to sub-units  

&lt;br/&gt;

--

- This design shares much in common with `\(\large a \times b\)` factorial designs, completely randomized block designs, and nested designs
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
