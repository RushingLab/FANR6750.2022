<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 14: Model selection and multimodel inference • FANR6750</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 14: Model selection and multimodel inference">
<meta property="og:description" content="FANR6750">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FANR6750</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2021.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/01_basic_stats/01_basic_stats.html">Lecture 1: Basic concepts in statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/02_t-tests/02_t-tests.html">Lecture 2: t-tests</a>
    </li>
    <li>
      <a href="../articles/lectures/03_anova/03_anova.html">Lecture 3: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/04_mult_comparisons/04_mult_comparisons.html">Lecture 4: Multiple comparisons</a>
    </li>
    <li>
      <a href="../articles/lectures/05_contrasts/05_contrasts.html">Lecture 5: Contrasts</a>
    </li>
    <li>
      <a href="../articles/lectures/06_power-analysis/06_power-analysis.html">Lecture 6: Power analysis</a>
    </li>
    <li>
      <a href="../articles/lectures/07_estimation/07_estimation.html">Lecture 7: Estimation</a>
    </li>
    <li>
      <a href="../articles/lectures/08_assumptions/08_assumptions.html">Lecture 8: ANOVA assumptions</a>
    </li>
    <li>
      <a href="../articles/lectures/09_nonparametrics/09_nonparametrics.html">Lecture 9: Non-parametric statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/10_blocking/10_blocking.html">Lecture 10: Blocking</a>
    </li>
    <li>
      <a href="../articles/lectures/11_raneff/11_raneff.html">Lecture 11: Random effects</a>
    </li>
    <li>
      <a href="../articles/lectures/12_factorial/12_factorial.html">Lecture 12: Factorial designs</a>
    </li>
    <li>
      <a href="../articles/lectures/13_nesting/13_nesting.html">Lecture 13: Nested designs</a>
    </li>
    <li>
      <a href="../articles/lectures/14_splitplot/14_splitplot.html">Lecture 14: Split plot designs</a>
    </li>
    <li>
      <a href="../articles/lectures/15_repeated_measures/15_repeated_measures.html">Lecture 15: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lectures/16_ANCOVA/16_ANCOVA.html">Lecture 16: ANCOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/17_lm/17_lm.html">Lecture 17: Linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/18_glm/18_glm.html">Lecture 18: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/19_model_selection/19_model_selection.html">Lecture 19: Model selection</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab01_Intro_to_R.html">Lab 1: Introduction to R</a>
    </li>
    <li>
      <a href="../articles/lab02_t-tests.html">Lab 2: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab03_ANOVA.html">Lab 3: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab04_contrasts.html">Lab 4: Contrasts, estimation, and power analysis</a>
    </li>
    <li>
      <a href="../articles/lab05_assump_nonpar.html">Lab 5: Assumptions of ANOVA, tranformations, and non-parametric tests</a>
    </li>
    <li>
      <a href="../articles/lab06_blocking.html">Lab 6: Randomized Complete Block Design</a>
    </li>
    <li>
      <a href="../articles/lab07_factorial.html">Lab 7: Factorial designs</a>
    </li>
    <li>
      <a href="../articles/lab08_nested.html">Lab 8: Nested ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab09_splitplot.html">Lab 9: Split plot designs</a>
    </li>
    <li>
      <a href="../articles/lab10_repeated_measures.html">Lab 10: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lab11_ANCOVA.html">Lab 11: ANCOVA</a>
    </li>
    <li>
      <a href="../articles/lab12_lm.html">Lab 12: Linear models</a>
    </li>
    <li>
      <a href="../articles/lab13_glm.html">Lab 13: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/lab14_model_selection.html">Lab 14: Model selection and multi-model inference</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework.html">Assignment instructions</a>
    </li>
    <li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/Rmarkdown.html">R Markdown reference</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="lab14_model_selection_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 14: Model selection and multimodel inference</h1>
            <h3 class="subtitle">FANR 6750: Experimental Methods in Forestry and Natural Resources Research</h3>
                        <h4 class="author">Fall 2021</h4>
            
      
      
      <div class="hidden name"><code>lab14_model_selection.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<ol style="list-style-type: decimal">
<li><p>Model fitting</p></li>
<li><p>Model selection</p></li>
<li><p>Multi-model inference</p></li>
</ol>
<div id="model-fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#model-fitting" class="anchor"></a>Model fitting</h2>
<p>We will start by fitting several alternative models to explain avian richness across Switzerland:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"swissData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">swissData</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
elevation
</th>
<th style="text-align:right;">
forest
</th>
<th style="text-align:left;">
water
</th>
<th style="text-align:right;">
sppRichness
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
450
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:right;">
450
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
51
</td>
</tr>
<tr>
<td style="text-align:right;">
1050
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
46
</td>
</tr>
<tr>
<td style="text-align:right;">
950
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
31
</td>
</tr>
<tr>
<td style="text-align:right;">
1150
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
550
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
43
</td>
</tr>
</tbody>
</table>
<p>The four linear models contain different combinations of forest cover, elevation, and water:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">sppRichness</span> <span class="op">~</span> <span class="va">forest</span>, data <span class="op">=</span> <span class="va">swissData</span><span class="op">)</span>
<span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">sppRichness</span> <span class="op">~</span> <span class="va">elevation</span>, data <span class="op">=</span> <span class="va">swissData</span><span class="op">)</span>
<span class="va">fm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">sppRichness</span> <span class="op">~</span> <span class="va">forest</span> <span class="op">+</span> <span class="va">elevation</span> <span class="op">+</span> <span class="va">water</span>, data <span class="op">=</span> <span class="va">swissData</span><span class="op">)</span>
<span class="va">fm4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">sppRichness</span> <span class="op">~</span> <span class="va">forest</span> <span class="op">+</span> <span class="va">elevation</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">elevation</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">water</span>, data <span class="op">=</span> <span class="va">swissData</span><span class="op">)</span></code></pre></div>
<p>Critically, all four of these models represent plausible hypotheses about factors that influence avian richness. We have no <em>a priori</em> knowledge of which model might be a better explanation for observed patterns.</p>
<p>Let’s look for closely at the output from model 4:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fm4</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = sppRichness ~ forest + elevation + I(elevation^2) + </span>
<span class="co">#&gt;     water, data = swissData)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -11.314  -3.205  -0.377   3.334  15.083 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)     4.52e+01   1.29e+00   35.14  &lt; 2e-16 ***</span>
<span class="co">#&gt; forest          2.31e-01   1.28e-02   18.11  &lt; 2e-16 ***</span>
<span class="co">#&gt; elevation      -1.02e-02   2.57e-03   -3.95   0.0001 ***</span>
<span class="co">#&gt; I(elevation^2)  6.10e-08   9.66e-07    0.06   0.9497    </span>
<span class="co">#&gt; waterYes       -3.01e+00   6.82e-01   -4.42  1.5e-05 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 4.95 on 262 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.793,  Adjusted R-squared:  0.79 </span>
<span class="co">#&gt; F-statistic:  251 on 4 and 262 DF,  p-value: &lt;2e-16</span></code></pre></div>
<p>What does each parameter represent?</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/summary.aov.html">summary.aov</a></span><span class="op">(</span><span class="va">fm4</span><span class="op">)</span>
<span class="co">#&gt;                 Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span>
<span class="co">#&gt; forest           1  13311   13311  542.40 &lt; 2e-16 ***</span>
<span class="co">#&gt; elevation        1  10820   10820  440.89 &lt; 2e-16 ***</span>
<span class="co">#&gt; I(elevation^2)   1      7       7    0.27     0.6    </span>
<span class="co">#&gt; water            1    479     479   19.52 1.5e-05 ***</span>
<span class="co">#&gt; Residuals      262   6430      25                    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Using the ANOVA table, we could compute AIC using the equation <span class="math inline">\(AIC = n \log(RSS/n) + 2K\)</span>, where RSS is the residual sum-of-squares. However, we will use the more general formula: <span class="math inline">\(AIC = −2L(\hat{\theta}; y) + 2K\)</span>.</p>
</div>
<div id="model-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#model-selection" class="anchor"></a>Model selection</h2>
<p>First, let’s calculate AIC by hand:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Sample size</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">swissData</span><span class="op">)</span>

<span class="co"># Log-likelihood for each model</span>
<span class="va">logL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">fm3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">fm4</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Number of parameters</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>

<span class="co"># AIC</span>
<span class="va">AIC</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="va">logL</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">K</span>

<span class="co"># delta AIC</span>
<span class="va">delta</span> <span class="op">&lt;-</span> <span class="va">AIC</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">AIC</span><span class="op">)</span>

<span class="co">#AIC Weights</span>
<span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">delta</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>And now we can create the AIC table:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Put vectors in data.frame</span>
<span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">logL</span>, <span class="va">K</span>, <span class="va">AIC</span>, <span class="va">delta</span>, <span class="va">w</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">ms</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"fm1"</span>, <span class="st">"fm2"</span>, <span class="st">"fm3"</span>, <span class="st">"fm4"</span><span class="op">)</span>
<span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">ms</span>, <span class="op">-</span><span class="va">w</span><span class="op">)</span> <span class="co"># arrange by descending weight</span>
<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">ms</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
logL
</th>
<th style="text-align:right;">
K
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
delta
</th>
<th style="text-align:right;">
w
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
fm3
</td>
<td style="text-align:right;">
-803.6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1617
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.73
</td>
</tr>
<tr>
<td style="text-align:left;">
fm4
</td>
<td style="text-align:right;">
-803.6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1619
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
fm2
</td>
<td style="text-align:right;">
-934.1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1874
</td>
<td style="text-align:right;">
257.0
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
fm1
</td>
<td style="text-align:right;">
-939.0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1884
</td>
<td style="text-align:right;">
266.9
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
</tbody>
</table>
<p>Just to check our results, we can do the same thing using <code>R</code>’s built-in <code><a href="https://rdrr.io/r/stats/AIC.html">AIC()</a></code> function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ms2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">fm1</span>, <span class="va">fm2</span>, <span class="va">fm3</span>, <span class="va">fm4</span><span class="op">)</span>
<span class="va">ms2</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">ms2</span>, <span class="va">AIC</span><span class="op">)</span> <span class="co"># arrange by AIC</span>
<span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">ms2</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
AIC
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
fm3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1617
</td>
</tr>
<tr>
<td style="text-align:left;">
fm4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1619
</td>
</tr>
<tr>
<td style="text-align:left;">
fm2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1874
</td>
</tr>
<tr>
<td style="text-align:left;">
fm1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1884
</td>
</tr>
</tbody>
</table>
<hr>
<p>Note that ff we had used the residual sums-of-squares instead of the log-likelihoods, the AIC values would have been different, but the <span class="math inline">\(\Delta\)</span>AIC values would have been the same. Either approach is fine with linear models, but log-likelihoods must be used with GLMs and other models fit using maximum likelihood</p>
<hr>
</div>
<div id="multi-model-inference" class="section level2">
<h2 class="hasAnchor">
<a href="#multi-model-inference" class="anchor"></a>Multi-model inference</h2>
<p>Based on AIC scores, model 3 appears to be the “best” model but there’s also reasonable support for other models. What if we want to predict avian richness using all of the models? Why might we want to do this?</p>
<p>First, let’s estimate the expected number of species at 1000m elevation, 25% forest cover, and no water, for each model:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">predData1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>elevation <span class="op">=</span> <span class="fl">1000</span>, 
                         forest <span class="op">=</span> <span class="fl">25</span>, 
                         water <span class="op">=</span> <span class="st">"No"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   elevation forest water</span>
<span class="co">#&gt; 1      1000     25    No</span>

<span class="va">E1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fm1</span>, newdata <span class="op">=</span> <span class="va">predData1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">E1</span><span class="op">)</span> <span class="co"># remove names (optional)</span>
<span class="co">#&gt; [1] 37.9</span>

<span class="va">E2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fm2</span>, newdata <span class="op">=</span> <span class="va">predData1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">E2</span><span class="op">)</span>
<span class="co">#&gt; [1] 42.53</span>

<span class="va">E3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fm3</span>, newdata <span class="op">=</span> <span class="va">predData1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">E3</span><span class="op">)</span>
<span class="co">#&gt; [1] 40.89</span>

<span class="va">E4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fm4</span>, newdata <span class="op">=</span> <span class="va">predData1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">E4</span><span class="op">)</span>
<span class="co">#&gt; [1] 40.86</span></code></pre></div>
<p>What is the expected number of species at 1000m, 25% forest cover, and no water, averaged over all 4 models?</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">E1</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">E2</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">E3</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">E4</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>
<span class="co">#&gt;     1 </span>
<span class="co">#&gt; 40.88</span></code></pre></div>
<p>What if we want to predict species richness over range of forest cover? First, the predictions for each model:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predData2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>forest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, length <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>, 
                        elevation <span class="op">=</span> <span class="fl">1000</span>, 
                        water <span class="op">=</span> <span class="st">"No"</span><span class="op">)</span>
<span class="va">E1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fm1</span>, newdata <span class="op">=</span> <span class="va">predData2</span><span class="op">)</span>
<span class="va">E2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fm2</span>, newdata <span class="op">=</span> <span class="va">predData2</span><span class="op">)</span>
<span class="va">E3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fm3</span>, newdata <span class="op">=</span> <span class="va">predData2</span><span class="op">)</span>
<span class="va">E4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fm4</span>, newdata <span class="op">=</span> <span class="va">predData2</span><span class="op">)</span>

<span class="va">Emat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">E1</span>, <span class="va">E2</span>, <span class="va">E3</span>, <span class="va">E4</span><span class="op">)</span></code></pre></div>
<p>How do we model-average these vectors?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Eavg</span> <span class="op">&lt;-</span> <span class="va">Emat</span> <span class="op">%*%</span> <span class="va">w</span></code></pre></div>
<p>Be sure you understand what <code>R</code> is doing here and how it results in the appropriate predictions.</p>
<p>And plot the predictions from each model and the model averaged results. First we need to combine the predictions into a single data frame. Then we’ll use some creative (and perhaps not every effective) sizing so that we can see the overlapping predictions from models 3, 4, and the model-averaged results:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="va">predDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">Eavg</span>, <span class="va">E1</span>, <span class="va">E2</span>, <span class="va">E3</span>, <span class="va">E4</span><span class="op">)</span>,
                     Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Model average"</span>, <span class="st">"Model 1"</span>, <span class="st">"Model 2"</span>, <span class="st">"Model 3"</span>, <span class="st">"Model 4"</span><span class="op">)</span>,
                                 each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">E1</span><span class="op">)</span><span class="op">)</span>,
                     forest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">predData2</span><span class="op">$</span><span class="va">forest</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>

<span class="va">predDF</span><span class="op">$</span><span class="va">Model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">predDF</span><span class="op">$</span><span class="va">Model</span>, 
                       levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Model average"</span>, <span class="st">"Model 4"</span>, <span class="st">"Model 3"</span>, <span class="st">"Model 2"</span>, <span class="st">"Model 1"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">swissData</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">forest</span>, y <span class="op">=</span> <span class="va">sppRichness</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predDF</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">forest</span>, y <span class="op">=</span> <span class="va">pred</span>, color <span class="op">=</span> <span class="va">Model</span>, size <span class="op">=</span> <span class="va">Model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_size_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">"Forest cover"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Species richness"</span><span class="op">)</span></code></pre></div>
<p><img src="lab14_model_selection_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
</div>
</div>
<div id="assignment-not-to-be-turned-in" class="section level1">
<h1 class="hasAnchor">
<a href="#assignment-not-to-be-turned-in" class="anchor"></a>Assignment (not to be turned in!)</h1>
<p>Create an R markdown report, using the <code>jayData</code> from lab 12, to do the following:</p>
<ol style="list-style-type: decimal">
<li><p>Fit four linear models of jay abundance. Include elevation all four models. Include at least one interaction, and one quadratic term for elevation.</p></li>
<li><p>Create AIC table by hand, not using <code>R</code>’s AIC function</p></li>
<li><p>Model-average regression lines of jay abundance and elevation. Plot the averaged regression line along with the regression lines from each model.</p></li>
<li><p>Bonus: Create a map showing the model-averaged estimates of jay abundance on Santa Cruz Island. (Hint: use <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> with <code>cruzData</code> supplied as the <code>newdata</code> argument)</p></li>
</ol>
<p>As always:</p>
<ul>
<li><p>Be sure the output type is set to: <code>output: html_document</code></p></li>
<li><p>Title the document: <code>title: "Lab 14 assignment"</code></p></li>
<li><p>Be sure to include your first and last name in the <code>author</code> section</p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code> chunks so we can see both your code and the output</p></li>
<li><p>Please upload both the <code>html</code> and <code>.Rmd</code> files when you submit your assignment</p></li>
<li><p>See the R Markdown reference sheet for help with creating <code>R</code> chunks, equations, tables, etc.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
