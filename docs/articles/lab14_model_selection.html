<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 14: Model selection and multimodel inference • FANR6750</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 14: Model selection and multimodel inference">
<meta property="og:description" content="FANR6750">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FANR6750</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2022.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/01_basic_stats/01_basic_stats.html">Lecture 1: Basic concepts in statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/02_estimation/02_estimation.html">Lecture 2: Principles of Estimation</a>
    </li>
    <li>
      <a href="../articles/lectures/03_models/03_models.html">Lecture 3: Introduction to Statistical Modeling</a>
    </li>
    <li>
      <a href="../articles/lectures/04_NHST/04_NHST.html">Lecture 4: t-tests and Null Hypothesis Testing</a>
    </li>
    <li>
      <a href="../articles/lectures/05_anova/05_anova.html">Lecture 5: One-way ANOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/06_mult_comparisons/06_mult_comparisons.html">Lecture 6: Multiple Comparisons</a>
    </li>
    <li>
      <a href="../articles/lectures/07_contrasts/07_contrasts.html">Lecture 7: Contrasts</a>
    </li>
    <li>
      <a href="../articles/lectures/08_power-analysis/08_power-analysis.html">Lecture 8: Power Analysis</a>
    </li>
    <li>
      <a href="../articles/lectures/09_assumptions/09_assumptions.html">Lecture 9: Assumptions and transformations</a>
    </li>
    <li>
      <a href="../articles/lectures/10_estimation/10_estimation.html">Lecture 10: Confidence intervals</a>
    </li>
    <li>
      <a href="../articles/lectures/11_blocking/11_blocking.html">Lecture 11: Blocking</a>
    </li>
    <li>
      <a href="../articles/lectures/12_raneff/12_raneff.html">Lecture 12: Random effects</a>
    </li>
    <li>
      <a href="../articles/lectures/13_factorial/13_factorial.html">Lecture 13: Factorial designs</a>
    </li>
    <li>
      <a href="../articles/lectures/14_nesting/14_nesting.html">Lecture 14: Nested effects</a>
    </li>
    <li>
      <a href="../articles/lectures/15_splitplot/15_splitplot.html">Lecture 15: Split-plot designs</a>
    </li>
    <li>
      <a href="../articles/lectures/16_repeated_measures/16_repeated_measures.html">Lecture 16: Repeated measures</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab01_Intro_to_R.html">Lab 1: Introduction to R</a>
    </li>
    <li>
      <a href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to RMarkdown and Projects</a>
    </li>
    <li>
      <a href="../articles/lab03_t-tests.html">Lab 3: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab04_ANOVA.html">Lab 4: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab05_contrasts.html">Lab 5: Contrasts</a>
    </li>
    <li>
      <a href="../articles/lab06_assump_nonpar.html">Lab 6: Assumptions of ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab07_blocking.html">Lab 7: Blocking</a>
    </li>
    <li>
      <a href="../articles/lab08_factorial.html">Lab 8: Factorial</a>
    </li>
    <li>
      <a href="../articles/lab09_nested.html">Lab 9: Nesting</a>
    </li>
    <li>
      <a href="../articles/lab10_splitplot.html">Lab 10: Split-plot design</a>
    </li>
    <li>
      <a href="../articles/lab11_repeated_measures.html">Lab 11: Repeated Measures</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework.html">Assignment instructions</a>
    </li>
    <li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/RMarkdown.html">R Markdown reference</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Creating publication-quality graphics</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 14: Model selection and multimodel
inference</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2021</h4>
            
      
      
      <div class="hidden name"><code>lab14_model_selection.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Model fitting</p></li>
<li><p>Model selection</p></li>
<li><p>Multi-model inference</p></li>
</ol>
<div class="section level3">
<h3 id="model-fitting">Model fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h3>
<p>We will start by fitting several alternative models to explain avian
richness across Switzerland:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"swissData"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">swissData</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:right;">
elevation
</th>
<th style="text-align:right;">
forest
</th>
<th style="text-align:left;">
water
</th>
<th style="text-align:right;">
sppRichness
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
450
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:right;">
450
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
51
</td>
</tr>
<tr>
<td style="text-align:right;">
1050
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
46
</td>
</tr>
<tr>
<td style="text-align:right;">
950
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
31
</td>
</tr>
<tr>
<td style="text-align:right;">
1150
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
550
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:right;">
43
</td>
</tr>
</tbody>
</table>
<p>The four linear models contain different combinations of forest
cover, elevation, and water:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">sppRichness</span> <span class="op">~</span> <span class="va">forest</span>, data <span class="op">=</span> <span class="va">swissData</span><span class="op">)</span></span>
<span><span class="va">fm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">sppRichness</span> <span class="op">~</span> <span class="va">elevation</span>, data <span class="op">=</span> <span class="va">swissData</span><span class="op">)</span></span>
<span><span class="va">fm3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">sppRichness</span> <span class="op">~</span> <span class="va">forest</span> <span class="op">+</span> <span class="va">elevation</span> <span class="op">+</span> <span class="va">water</span>, data <span class="op">=</span> <span class="va">swissData</span><span class="op">)</span></span>
<span><span class="va">fm4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">sppRichness</span> <span class="op">~</span> <span class="va">forest</span> <span class="op">+</span> <span class="va">elevation</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">elevation</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">water</span>, data <span class="op">=</span> <span class="va">swissData</span><span class="op">)</span></span></code></pre></div>
<p>Critically, all four of these models represent plausible hypotheses
about factors that influence avian richness. We have no <em>a
priori</em> knowledge of which model might be a better explanation for
observed patterns.</p>
<p>Let’s look for closely at the output from model 4:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fm4</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = sppRichness ~ forest + elevation + I(elevation^2) + </span></span>
<span><span class="co">#&gt;     water, data = swissData)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -11.314  -3.205  -0.377   3.334  15.083 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)     4.52e+01   1.29e+00   35.14  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; forest          2.31e-01   1.28e-02   18.11  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; elevation      -1.02e-02   2.57e-03   -3.95   0.0001 ***</span></span>
<span><span class="co">#&gt; I(elevation^2)  6.10e-08   9.66e-07    0.06   0.9497    </span></span>
<span><span class="co">#&gt; waterYes       -3.01e+00   6.82e-01   -4.42  1.5e-05 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 4.95 on 262 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.793,  Adjusted R-squared:  0.79 </span></span>
<span><span class="co">#&gt; F-statistic:  251 on 4 and 262 DF,  p-value: &lt;2e-16</span></span></code></pre></div>
<p>What does each parameter represent?</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/summary.aov.html" class="external-link">summary.aov</a></span><span class="op">(</span><span class="va">fm4</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; forest           1  13311   13311  542.40 &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; elevation        1  10820   10820  440.89 &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; I(elevation^2)   1      7       7    0.27     0.6    </span></span>
<span><span class="co">#&gt; water            1    479     479   19.52 1.5e-05 ***</span></span>
<span><span class="co">#&gt; Residuals      262   6430      25                    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Using the ANOVA table, we could compute AIC using the equation <span class="math inline">\(AIC = n \log(RSS/n) + 2K\)</span>, where RSS is
the residual sum-of-squares. However, we will use the more general
formula: <span class="math inline">\(AIC = −2L(\hat{\theta}; y) +
2K\)</span>.</p>
</div>
<div class="section level3">
<h3 id="model-selection">Model selection<a class="anchor" aria-label="anchor" href="#model-selection"></a>
</h3>
<p>First, let’s calculate AIC by hand:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample size</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">swissData</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Log-likelihood for each model</span></span>
<span><span class="va">logL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fm1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fm2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fm3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fm4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Number of parameters</span></span>
<span><span class="va">K</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># AIC</span></span>
<span><span class="va">AIC</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="va">logL</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">K</span></span>
<span></span>
<span><span class="co"># delta AIC</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="va">AIC</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">AIC</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#AIC Weights</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">delta</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And now we can create the AIC table:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Put vectors in data.frame</span></span>
<span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">logL</span>, <span class="va">K</span>, <span class="va">AIC</span>, <span class="va">delta</span>, <span class="va">w</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ms</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fm1"</span>, <span class="st">"fm2"</span>, <span class="st">"fm3"</span>, <span class="st">"fm4"</span><span class="op">)</span></span>
<span><span class="va">ms</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">ms</span>, <span class="op">-</span><span class="va">w</span><span class="op">)</span> <span class="co"># arrange by descending weight</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">ms</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
logL
</th>
<th style="text-align:right;">
K
</th>
<th style="text-align:right;">
AIC
</th>
<th style="text-align:right;">
delta
</th>
<th style="text-align:right;">
w
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
fm3
</td>
<td style="text-align:right;">
-803.6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1617
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.73
</td>
</tr>
<tr>
<td style="text-align:left;">
fm4
</td>
<td style="text-align:right;">
-803.6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1619
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
<tr>
<td style="text-align:left;">
fm2
</td>
<td style="text-align:right;">
-934.1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1874
</td>
<td style="text-align:right;">
257.0
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
fm1
</td>
<td style="text-align:right;">
-939.0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1884
</td>
<td style="text-align:right;">
266.9
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
</tbody>
</table>
<p>Just to check our results, we can do the same thing using
<code>R</code>’s built-in <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC()</a></code> function:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ms2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fm1</span>, <span class="va">fm2</span>, <span class="va">fm3</span>, <span class="va">fm4</span><span class="op">)</span></span>
<span><span class="va">ms2</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">ms2</span>, <span class="va">AIC</span><span class="op">)</span> <span class="co"># arrange by AIC</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">ms2</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
AIC
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
fm3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1617
</td>
</tr>
<tr>
<td style="text-align:left;">
fm4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1619
</td>
</tr>
<tr>
<td style="text-align:left;">
fm2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1874
</td>
</tr>
<tr>
<td style="text-align:left;">
fm1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1884
</td>
</tr>
</tbody>
</table>
<hr>
<p>Note that ff we had used the residual sums-of-squares instead of the
log-likelihoods, the AIC values would have been different, but the <span class="math inline">\(\Delta\)</span>AIC values would have been the
same. Either approach is fine with linear models, but log-likelihoods
must be used with GLMs and other models fit using maximum likelihood</p>
<hr>
</div>
<div class="section level3">
<h3 id="multi-model-inference">Multi-model inference<a class="anchor" aria-label="anchor" href="#multi-model-inference"></a>
</h3>
<p>Based on AIC scores, model 3 appears to be the “best” model but
there’s also reasonable support for other models. What if we want to
predict avian richness using all of the models? Why might we want to do
this?</p>
<p>First, let’s estimate the expected number of species at 1000m
elevation, 25% forest cover, and no water, for each model:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">predData1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>elevation <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                         forest <span class="op">=</span> <span class="fl">25</span>, </span>
<span>                         water <span class="op">=</span> <span class="st">"No"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   elevation forest water</span></span>
<span><span class="co">#&gt; 1      1000     25    No</span></span>
<span></span>
<span><span class="va">E1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm1</span>, newdata <span class="op">=</span> <span class="va">predData1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">E1</span><span class="op">)</span> <span class="co"># remove names (optional)</span></span>
<span><span class="co">#&gt; [1] 37.9</span></span>
<span></span>
<span><span class="va">E2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm2</span>, newdata <span class="op">=</span> <span class="va">predData1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">E2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 42.53</span></span>
<span></span>
<span><span class="va">E3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm3</span>, newdata <span class="op">=</span> <span class="va">predData1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">E3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 40.89</span></span>
<span></span>
<span><span class="va">E4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm4</span>, newdata <span class="op">=</span> <span class="va">predData1</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">E4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 40.86</span></span></code></pre></div>
<p>What is the expected number of species at 1000m, 25% forest cover,
and no water, averaged over all 4 models?</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E1</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">E2</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">E3</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">E4</span> <span class="op">*</span> <span class="va">w</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#&gt;     1 </span></span>
<span><span class="co">#&gt; 40.88</span></span></code></pre></div>
<p>What if we want to predict species richness over range of forest
cover? First, the predictions for each model:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predData2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>forest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, length <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>, </span>
<span>                        elevation <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                        water <span class="op">=</span> <span class="st">"No"</span><span class="op">)</span></span>
<span><span class="va">E1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm1</span>, newdata <span class="op">=</span> <span class="va">predData2</span><span class="op">)</span></span>
<span><span class="va">E2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm2</span>, newdata <span class="op">=</span> <span class="va">predData2</span><span class="op">)</span></span>
<span><span class="va">E3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm3</span>, newdata <span class="op">=</span> <span class="va">predData2</span><span class="op">)</span></span>
<span><span class="va">E4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fm4</span>, newdata <span class="op">=</span> <span class="va">predData2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Emat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">E1</span>, <span class="va">E2</span>, <span class="va">E3</span>, <span class="va">E4</span><span class="op">)</span></span></code></pre></div>
<p>How do we model-average these vectors?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Eavg</span> <span class="op">&lt;-</span> <span class="va">Emat</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">w</span></span></code></pre></div>
<p>Be sure you understand what <code>R</code> is doing here and how it
results in the appropriate predictions.</p>
<p>And plot the predictions from each model and the model averaged
results. First we need to combine the predictions into a single data
frame. Then we’ll use some creative (and perhaps not every effective)
sizing so that we can see the overlapping predictions from models 3, 4,
and the model-averaged results:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">predDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Eavg</span>, <span class="va">E1</span>, <span class="va">E2</span>, <span class="va">E3</span>, <span class="va">E4</span><span class="op">)</span>,</span>
<span>                     Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Model average"</span>, <span class="st">"Model 1"</span>, <span class="st">"Model 2"</span>, <span class="st">"Model 3"</span>, <span class="st">"Model 4"</span><span class="op">)</span>,</span>
<span>                                 each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">E1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     forest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">predData2</span><span class="op">$</span><span class="va">forest</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predDF</span><span class="op">$</span><span class="va">Model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">predDF</span><span class="op">$</span><span class="va">Model</span>, </span>
<span>                       levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Model average"</span>, <span class="st">"Model 4"</span>, <span class="st">"Model 3"</span>, <span class="st">"Model 2"</span>, <span class="st">"Model 1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">swissData</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">forest</span>, y <span class="op">=</span> <span class="va">sppRichness</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">predDF</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">forest</span>, y <span class="op">=</span> <span class="va">pred</span>, color <span class="op">=</span> <span class="va">Model</span>, size <span class="op">=</span> <span class="va">Model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_size_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span><span class="st">"Forest cover"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Species richness"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab14_model_selection_files/figure-html/unnamed-chunk-14-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="assignment-not-to-be-turned-in">Assignment (not to be turned in!)<a class="anchor" aria-label="anchor" href="#assignment-not-to-be-turned-in"></a>
</h2>
<p>Create an R markdown report, using the <code>jayData</code> from lab
12, to do the following:</p>
<ol style="list-style-type: decimal">
<li><p>Fit four linear models of jay abundance. Include elevation all
four models. Include at least one interaction, and one quadratic term
for elevation.</p></li>
<li><p>Create AIC table by hand, not using <code>R</code>’s AIC
function</p></li>
<li><p>Model-average regression lines of jay abundance and elevation.
Plot the averaged regression line along with the regression lines from
each model.</p></li>
<li><p>Bonus: Create a map showing the model-averaged estimates of jay
abundance on Santa Cruz Island. (Hint: use <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> with
<code>cruzData</code> supplied as the <code>newdata</code>
argument)</p></li>
</ol>
<p>As always:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Title the document:
<code>title: "Lab 14 assignment"</code></p></li>
<li><p>Be sure to include your first and last name in the
<code>author</code> section</p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so we can see both your code and the output</p></li>
<li><p>Please upload both the <code>html</code> and <code>.Rmd</code>
files when you submit your assignment</p></li>
<li><p>See the R Markdown reference sheet for help with creating
<code>R</code> chunks, equations, tables, etc.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
