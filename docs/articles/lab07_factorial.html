<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 7: Factorial designs • FANR6750</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 7: Factorial designs">
<meta property="og:description" content="FANR6750">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FANR6750</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2021.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/01_basic_stats/01_basic_stats.html">Lecture 1: Basic concepts in statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/02_t-tests/02_t-tests.html">Lecture 2: t-tests</a>
    </li>
    <li>
      <a href="../articles/lectures/03_anova/03_anova.html">Lecture 3: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/04_mult_comparisons/04_mult_comparisons.html">Lecture 4: Multiple comparisons</a>
    </li>
    <li>
      <a href="../articles/lectures/05_contrasts/05_contrasts.html">Lecture 5: Contrasts</a>
    </li>
    <li>
      <a href="../articles/lectures/06_power-analysis/06_power-analysis.html">Lecture 6: Power analysis</a>
    </li>
    <li>
      <a href="../articles/lectures/07_estimation/07_estimation.html">Lecture 7: Estimation</a>
    </li>
    <li>
      <a href="../articles/lectures/08_assumptions/08_assumptions.html">Lecture 8: ANOVA assumptions</a>
    </li>
    <li>
      <a href="../articles/lectures/09_nonparametrics/09_nonparametrics.html">Lecture 9: Non-parametric statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/10_blocking/10_blocking.html">Lecture 10: Blocking</a>
    </li>
    <li>
      <a href="../articles/lectures/11_raneff/11_raneff.html">Lecture 11: Random effects</a>
    </li>
    <li>
      <a href="../articles/lectures/12_factorial/12_factorial.html">Lecture 12: Factorial designs</a>
    </li>
    <li>
      <a href="../articles/lectures/13_nesting/13_nesting.html">Lecture 13: Nested designs</a>
    </li>
    <li>
      <a href="../articles/lectures/14_splitplot/14_splitplot.html">Lecture 14: Split plot designs</a>
    </li>
    <li>
      <a href="../articles/lectures/15_repeated_measures/15_repeated_measures.html">Lecture 15: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lectures/16_ANCOVA/16_ANCOVA.html">Lecture 16: ANCOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/17_lm/17_lm.html">Lecture 17: Linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/18_glm/18_glm.html">Lecture 18: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/19_model_selection/19_model_selection.html">Lecture 19: Model selection</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab01_Intro_to_R.html">Lab 1: Introduction to R</a>
    </li>
    <li>
      <a href="../articles/lab02_t-tests.html">Lab 2: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab03_ANOVA.html">Lab 3: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab04_contrasts.html">Lab 4: Contrasts, estimation, and power analysis</a>
    </li>
    <li>
      <a href="../articles/lab05_assump_nonpar.html">Lab 5: Assumptions of ANOVA, tranformations, and non-parametric tests</a>
    </li>
    <li>
      <a href="../articles/lab06_blocking.html">Lab 6: Randomized Complete Block Design</a>
    </li>
    <li>
      <a href="../articles/lab07_factorial.html">Lab 7: Factorial designs</a>
    </li>
    <li>
      <a href="../articles/lab08_nested.html">Lab 8: Nested ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab09_splitplot.html">Lab 9: Split plot designs</a>
    </li>
    <li>
      <a href="../articles/lab10_repeated_measures.html">Lab 10: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lab11_ANCOVA.html">Lab 11: ANCOVA</a>
    </li>
    <li>
      <a href="../articles/lab12_lm.html">Lab 12: Linear models</a>
    </li>
    <li>
      <a href="../articles/lab13_glm.html">Lab 13: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/lab14_model_selection.html">Lab 14: Model selection and multi-model inference</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework.html">Assignment instructions</a>
    </li>
    <li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/Rmarkdown.html">R Markdown reference</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="lab07_factorial_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 7: Factorial designs</h1>
            <h3 class="subtitle">FANR 6750: Experimental Methods in Forestry and Natural Resources Research</h3>
                        <h4 class="author">Fall 2021</h4>
            
      
      
      <div class="hidden name"><code>lab07_factorial.Rmd</code></div>

    </div>

    
    
<div id="situation" class="section level1">
<h1 class="hasAnchor">
<a href="#situation" class="anchor"></a>Situation</h1>
<p>When do we use a factorial design? Generally, when:</p>
<ul>
<li><p>There are 2 factors thought to influence the response variable</p></li>
<li><p>The effect of each factor might depend on the other factor</p></li>
<li><p>We have replicates for each combination of factors</p></li>
</ul>
</div>
<div id="example-effects-of-food-and-predators-on-microtus-voles" class="section level1">
<h1 class="hasAnchor">
<a href="#example-effects-of-food-and-predators-on-microtus-voles" class="anchor"></a>Example: effects of food and predators on <em>microtus</em> voles</h1>
<div id="the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#the-data" class="anchor"></a>The data</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"microtusData"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">microtusData</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:center;">
voles
</th>
<th style="text-align:center;">
food
</th>
<th style="text-align:center;">
predators
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
Present
</td>
</tr>
<tr>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
Present
</td>
</tr>
<tr>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
Present
</td>
</tr>
<tr>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
Present
</td>
</tr>
<tr>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
Present
</td>
</tr>
<tr>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
Present
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">microtusData</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    24 obs. of  3 variables:</span>
<span class="co">#&gt;  $ voles    : int  10 12 8 14 18 20 21 24 20 18 ...</span>
<span class="co">#&gt;  $ food     : int  0 0 0 0 1 1 1 1 2 2 ...</span>
<span class="co">#&gt;  $ predators: chr  "Present" "Present" "Present" "Present" ...</span></code></pre></div>
<p>As before, we need to convert <code>food</code> to a factor:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">microtusData</span><span class="op">$</span><span class="va">food</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">microtusData</span><span class="op">$</span><span class="va">food</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">microtusData</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    24 obs. of  3 variables:</span>
<span class="co">#&gt;  $ voles    : int  10 12 8 14 18 20 21 24 20 18 ...</span>
<span class="co">#&gt;  $ food     : Factor w/ 3 levels "0","1","2": 1 1 1 1 2 2 2 2 3 3 ...</span>
<span class="co">#&gt;  $ predators: chr  "Present" "Present" "Present" "Present" ...</span></code></pre></div>
<p>How many replicates do we have?</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">microtusData</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"predators"</span>,<span class="st">"food"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;          food</span>
<span class="co">#&gt; predators 0 1 2</span>
<span class="co">#&gt;   Absent  4 4 4</span>
<span class="co">#&gt;   Present 4 4 4</span></code></pre></div>
</div>
<div id="visualizing-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#visualizing-the-data" class="anchor"></a>Visualizing the data</h2>
<p>Visualizing multiple factors at once can sometimes be tricky. We’ll use the <code>fill</code> aestethic to make separate boxplots for each predation level, within each food treatment:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">microtusData</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">food</span>, y <span class="op">=</span> <span class="va">voles</span>, fill <span class="op">=</span> <span class="va">predators</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span><span class="op">(</span><span class="st">"Food treatment"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Number of voles"</span><span class="op">)</span></code></pre></div>
<p><img src="lab07_factorial_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<p>It’s clear from this figure that 1) food supplementation influences vole abundance, and 2) the effects of food treatment depend on whether predators are present or absent.</p>
</div>
</div>
<div id="factorial-design-using-aov" class="section level1">
<h1 class="hasAnchor">
<a href="#factorial-design-using-aov" class="anchor"></a>Factorial design using <code>aov()</code>
</h1>
<p>We can analyze the <em>microtus</em> data using the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function that we’re already familiar with. Note that to include the interaction of food and predators, we use <code>food * predators</code> in the formula:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## food * predators --&gt; food + predators + food:predators</span>
<span class="va">aov1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">voles</span> <span class="op">~</span> <span class="va">food</span> <span class="op">*</span> <span class="va">predators</span>, data <span class="op">=</span> <span class="va">microtusData</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span>
<span class="co">#&gt;                Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span>
<span class="co">#&gt; food            2   1337     669    40.6 2.1e-07 ***</span>
<span class="co">#&gt; predators       1    975     975    59.2 4.3e-07 ***</span>
<span class="co">#&gt; food:predators  2    518     259    15.7 0.00011 ***</span>
<span class="co">#&gt; Residuals      18    297      16                    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<hr>
<p>On your own, fit the model with the interaction (<code>food + predators</code>). How do the results compare?</p>
<hr>
<div id="follow-ups" class="section level2">
<h2 class="hasAnchor">
<a href="#follow-ups" class="anchor"></a>Follow ups</h2>
<p>Often in your own analysis, you will not stop at a significant ANOVA result. For example, maybe you want to further explore the effects of one factor while holding the other factor constant. In this case, we can further test whether food supplements influence vole abundance <em>when predators are present</em> using the <code>subset</code> argument:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">voles</span> <span class="op">~</span> <span class="va">food</span>, 
            data <span class="op">=</span> <span class="va">microtusData</span>, 
            subset <span class="op">=</span> <span class="va">predators</span> <span class="op">==</span> <span class="st">"Present"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)   </span>
<span class="co">#&gt; food         2  193.5    96.7    14.8 0.0014 **</span>
<span class="co">#&gt; Residuals    9   58.8     6.5                  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Or when predators are absent:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">voles</span> <span class="op">~</span> <span class="va">food</span>, 
            data <span class="op">=</span> <span class="va">microtusData</span>, 
            subset <span class="op">=</span> <span class="va">predators</span> <span class="op">==</span> <span class="st">"Absent"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;             Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span>
<span class="co">#&gt; food         2   1662     831    31.4 8.7e-05 ***</span>
<span class="co">#&gt; Residuals    9    238      26                    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Or maybe we want to test which levels are different using our old friend the Tukey HSD test, which for the factorial design will return both the “main” effect differences and the interaction:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span>
<span class="co">#&gt;   Tukey multiple comparisons of means</span>
<span class="co">#&gt;     95% family-wise confidence level</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit: aov(formula = voles ~ food * predators, data = microtusData)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $food</span>
<span class="co">#&gt;       diff    lwr    upr  p adj</span>
<span class="co">#&gt; 1-0 13.875  8.694 19.056 0.0000</span>
<span class="co">#&gt; 2-0 17.250 12.069 22.431 0.0000</span>
<span class="co">#&gt; 2-1  3.375 -1.806  8.556 0.2464</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $predators</span>
<span class="co">#&gt;                  diff    lwr    upr p adj</span>
<span class="co">#&gt; Present-Absent -12.75 -16.23 -9.267     0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`food:predators`</span>
<span class="co">#&gt;                       diff      lwr     upr  p adj</span>
<span class="co">#&gt; 1:Absent-0:Absent    18.00   8.8756  27.124 0.0001</span>
<span class="co">#&gt; 2:Absent-0:Absent    28.50  19.3756  37.624 0.0000</span>
<span class="co">#&gt; 0:Present-0:Absent   -2.50 -11.6244   6.624 0.9488</span>
<span class="co">#&gt; 1:Present-0:Absent    7.25  -1.8744  16.374 0.1684</span>
<span class="co">#&gt; 2:Present-0:Absent    3.50  -5.6244  12.624 0.8221</span>
<span class="co">#&gt; 2:Absent-1:Absent    10.50   1.3756  19.624 0.0189</span>
<span class="co">#&gt; 0:Present-1:Absent  -20.50 -29.6244 -11.376 0.0000</span>
<span class="co">#&gt; 1:Present-1:Absent  -10.75 -19.8744  -1.626 0.0158</span>
<span class="co">#&gt; 2:Present-1:Absent  -14.50 -23.6244  -5.376 0.0010</span>
<span class="co">#&gt; 0:Present-2:Absent  -31.00 -40.1244 -21.876 0.0000</span>
<span class="co">#&gt; 1:Present-2:Absent  -21.25 -30.3744 -12.126 0.0000</span>
<span class="co">#&gt; 2:Present-2:Absent  -25.00 -34.1244 -15.876 0.0000</span>
<span class="co">#&gt; 1:Present-0:Present   9.75   0.6256  18.874 0.0323</span>
<span class="co">#&gt; 2:Present-0:Present   6.00  -3.1244  15.124 0.3351</span>
<span class="co">#&gt; 2:Present-1:Present  -3.75 -12.8744   5.374 0.7781</span></code></pre></div>
</div>
</div>
<div id="visualizing-the-results" class="section level1">
<h1 class="hasAnchor">
<a href="#visualizing-the-results" class="anchor"></a>Visualizing the results</h1>
<p>Another follow up that will often be important is visualizing the results of the ANOVA model. In the case of the factorial design, this will generally involve making a graph of the predicted response (and associated uncertainty!) for each combination of factors.</p>
<p>To create the data that will form the basis of this visualization, we’ll first use the <code><a href="https://rdrr.io/r/stats/model.tables.html">model.tables()</a></code> function to compute the relevant means (i.e., predicted values) and standard errors:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.tables.html">model.tables</a></span><span class="op">(</span><span class="va">aov1</span>, type<span class="op">=</span><span class="st">"means"</span>, se <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Tables of means</span>
<span class="co">#&gt; Grand mean</span>
<span class="co">#&gt;       </span>
<span class="co">#&gt; 22.62 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  food </span>
<span class="co">#&gt; food</span>
<span class="co">#&gt;     0     1     2 </span>
<span class="co">#&gt; 12.25 26.12 29.50 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  predators </span>
<span class="co">#&gt; predators</span>
<span class="co">#&gt;  Absent Present </span>
<span class="co">#&gt;   29.00   16.25 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  food:predators </span>
<span class="co">#&gt;     predators</span>
<span class="co">#&gt; food Absent Present</span>
<span class="co">#&gt;    0 13.50  11.00  </span>
<span class="co">#&gt;    1 31.50  20.75  </span>
<span class="co">#&gt;    2 42.00  17.00  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Standard errors for differences of means</span>
<span class="co">#&gt;          food predators food:predators</span>
<span class="co">#&gt;         2.030     1.658          2.871</span>
<span class="co">#&gt; replic.     8        12              4</span></code></pre></div>
<p>Next, we’ll extract the group means</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">ybar_ij.</span> <span class="op">&lt;-</span> <span class="va">tab</span><span class="op">$</span><span class="va">tables</span><span class="op">$</span><span class="st">"food:predators"</span><span class="op">)</span>
<span class="co">#&gt;     predators</span>
<span class="co">#&gt; food Absent Present</span>
<span class="co">#&gt;    0 13.50  11.00  </span>
<span class="co">#&gt;    1 31.50  20.75  </span>
<span class="co">#&gt;    2 42.00  17.00</span></code></pre></div>
<p>What about confidence intervals? Notice that <code><a href="https://rdrr.io/r/stats/model.tables.html">model.tables()</a></code> returns “Standard errors for differences of means”.</p>
<p>Extending the formulas given in Dowdy et al. p. 300-2, to the <span class="math inline">\(A \times B\)</span> factorial case, the confidence interval for the difference in two <span class="math inline">\(A \times B\)</span> means is:</p>
<p><span class="math display">\[\Large CI_{1−\alpha} : \bar{y}_{ij.} − \bar{y}_{ij.′} \pm t_{1−\alpha/2,ab(n−1)}\times \sqrt{\frac{2MSE}{n}}\]</span></p>
<p>where <span class="math inline">\(n = 4\)</span> in the vole example.</p>
<p>To set up a plot of the group means, however, we need a confidence interval for each mean. We take out the ‘2’ from the SE expression (again, see Dowdy et al. p. 300):</p>
<p><span class="math display">\[\Large CI_{1−\alpha} : \bar{y}_{ij.} \pm t_{1−\alpha/2,ab(n−1)}\times \sqrt{\frac{MSE}{n}}\]</span></p>
<p>Where can we find MSE?</p>
<p>Answer: in the output of summary() of our aov1 object:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; List of 1</span>
<span class="co">#&gt;  $ :Classes 'anova' and 'data.frame':    4 obs. of  5 variables:</span>
<span class="co">#&gt;   ..$ Df     : num [1:4] 2 1 2 18</span>
<span class="co">#&gt;   ..$ Sum Sq : num [1:4] 1337 975 518 297</span>
<span class="co">#&gt;   ..$ Mean Sq: num [1:4] 668.6 975.4 259.1 16.5</span>
<span class="co">#&gt;   ..$ F value: num [1:4] 40.6 59.2 15.7 NA</span>
<span class="co">#&gt;   ..$ Pr(&gt;F) : num [1:4] 2.15e-07 4.27e-07 1.12e-04 NA</span>
<span class="co">#&gt;  - attr(*, "class")= chr [1:2] "summary.aov" "listof"</span></code></pre></div>
<p>Calculate the width of the confidence intervals:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">`Mean Sq`</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="co">## 16.5</span>
<span class="va">ybar_ij.SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">MSE</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span>
<span class="va">CI.half</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">0.975</span>, <span class="fl">18</span><span class="op">)</span> <span class="op">*</span> <span class="va">ybar_ij.SE</span>
<span class="op">(</span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="va">CI.half</span>, <span class="va">CI.half</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] -4.265  4.265</span></code></pre></div>
<p>Now we can create a data frame and plot the group means and confidence intervals:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">predicted.voles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Food <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,
                              Predators <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Absent"</span>, <span class="st">"Present"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,
                              voles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ybar_ij.</span><span class="op">)</span><span class="op">)</span>

<span class="co">## Add lower and upper confidence intervals</span>
<span class="va">predicted.voles</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">predicted.voles</span>, 
                                 LCI <span class="op">=</span> <span class="va">voles</span> <span class="op">+</span> <span class="va">CI</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
                                 UCI <span class="op">=</span> <span class="va">voles</span> <span class="op">+</span> <span class="va">CI</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>

<span class="co">## Plot results</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">predicted.voles</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Food</span>, y <span class="op">=</span> <span class="va">voles</span>, 
                            color <span class="op">=</span> <span class="va">Predators</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_path</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="va">Predators</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">LCI</span>, ymax <span class="op">=</span> <span class="va">UCI</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Predicted number of voles"</span><span class="op">)</span></code></pre></div>
<p><img src="lab07_factorial_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
</div>
<div id="assignment" class="section level1">
<h1 class="hasAnchor">
<a href="#assignment" class="anchor"></a>Assignment</h1>
<p><strong>Fictitious Scenario</strong></p>
<p>Acid rain has lowered the pH of many lakes in the northeastern United States, and as a result, fish populations have declined. Managers have resorted to aerial applications of lime (powdered calcium carbonate) in hopes of increasing pH.</p>
<p>To determine if lime applications result in increased pH, they applied equal amounts of lime to 15 lakes, and as a control, they applied the same amount of inert white powder to an additional 15 lakes.</p>
<p>Researchers suspected that the effect of lime might depend upon the buffering effects of the underlying bedrock.</p>
<p>To assess this hypothesis, the 30 lakes were chosen such that 10 had limestone bedrock, 10 had granite bedrock, and 10 had schist bedrock. Acidity was measured before and after each application, and the difference in pH is recorded in the <code>acidityData</code> data set:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"acidityData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">acidityData</span><span class="op">)</span>
<span class="co">#&gt;      pHdiff   bedrock treatment</span>
<span class="co">#&gt; 1  1.968718 Limestone      Lime</span>
<span class="co">#&gt; 2 -0.009063 Limestone      Lime</span>
<span class="co">#&gt; 3  1.355943 Limestone      Lime</span>
<span class="co">#&gt; 4 -0.079097 Limestone      Lime</span>
<span class="co">#&gt; 5 -1.836610 Limestone      Lime</span>
<span class="co">#&gt; 6 -1.006265 Limestone   Control</span></code></pre></div>
<p><strong>Questions/tasks</strong></p>
<ol style="list-style-type: decimal">
<li><p>What are the null and alternative hypotheses?</p></li>
<li><p>Test the null hypotheses using an <span class="math inline">\(A \times B\)</span> factorial ANOVA implemented with <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>.</p></li>
<li><p>Does the effect of lime depend upon the bedrock type? If so, how?</p></li>
</ol>
<p>Put your answers in an R Markdown report. Your report should include:</p>
<ol style="list-style-type: decimal">
<li><p>A well-formatted ANOVA table (with caption); and</p></li>
<li><p>A publication-quality plot of the estimated effect of lime on pH change, including 95% confidence intervals. The figure should also have a descriptive caption and any aesthetics (color, line type, etc.) should be clearly defined.</p></li>
</ol>
<p>You may format the report however you like but it should be well-organized, with relevant headers, plain text, and the elements described above.</p>
<p>As always:</p>
<ul>
<li><p>Be sure the output type is set to: <code>output: html_document</code></p></li>
<li><p>Title the document: <code>title: "Lab 7 assignment"</code></p></li>
<li><p>Be sure to include your first and last name in the <code>author</code> section</p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code> chunks so we can see both your code and the output</p></li>
<li><p>Please upload both the <code>html</code> and <code>.Rmd</code> files when you submit your assignment</p></li>
<li><p>See the R Markdown reference sheet for help with creating <code>R</code> chunks, equations, tables, etc.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
