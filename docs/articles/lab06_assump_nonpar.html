<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 6: Assumptions of ANOVA • FANR6750</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 6: Assumptions of ANOVA">
<meta property="og:description" content="FANR6750">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FANR6750</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2022.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/01_basic_stats/01_basic_stats.html">Lecture 1: Basic concepts in statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/02_estimation/02_estimation.html">Lecture 2: Principles of Estimation</a>
    </li>
    <li>
      <a href="../articles/lectures/03_models/03_models.html">Lecture 3: Introduction to Statistical Modeling</a>
    </li>
    <li>
      <a href="../articles/lectures/04_NHST/04_NHST.html">Lecture 4: t-tests and Null Hypothesis Testing</a>
    </li>
    <li>
      <a href="../articles/lectures/05_anova/05_anova.html">Lecture 5: One-way ANOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/06_mult_comparisons/06_mult_comparisons.html">Lecture 6: Multiple Comparisons</a>
    </li>
    <li>
      <a href="../articles/lectures/07_contrasts/07_contrasts.html">Lecture 7: Contrasts</a>
    </li>
    <li>
      <a href="../articles/lectures/08_power-analysis/08_power-analysis.html">Lecture 8: Power Analysis</a>
    </li>
    <li>
      <a href="../articles/lectures/09_assumptions/09_assumptions.html">Lecture 9: Assumptions and transformations</a>
    </li>
    <li>
      <a href="../articles/lectures/10_estimation/10_estimation.html">Lecture 10: Confidence intervals</a>
    </li>
    <li>
      <a href="../articles/lectures/11_blocking/11_blocking.html">Lecture 11: Blocking</a>
    </li>
    <li>
      <a href="../articles/lectures/12_raneff/12_raneff.html">Lecture 12: Random effects</a>
    </li>
    <li>
      <a href="../articles/lectures/13_factorial/13_factorial.html">Lecture 13: Factorial designs</a>
    </li>
    <li>
      <a href="../articles/lectures/14_nesting/14_nesting.html">Lecture 14: Nested effects</a>
    </li>
    <li>
      <a href="../articles/lectures/15_splitplot/15_splitplot.html">Lecture 15: Split-plot designs</a>
    </li>
    <li>
      <a href="../articles/lectures/16_repeated_measures/16_repeated_measures.html">Lecture 16: Repeated measures</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab01_Intro_to_R.html">Lab 1: Introduction to R</a>
    </li>
    <li>
      <a href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to RMarkdown and Projects</a>
    </li>
    <li>
      <a href="../articles/lab03_t-tests.html">Lab 3: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab04_ANOVA.html">Lab 4: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab05_contrasts.html">Lab 5: Contrasts</a>
    </li>
    <li>
      <a href="../articles/lab06_assump_nonpar.html">Lab 6: Assumptions of ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab07_blocking.html">Lab 7: Blocking</a>
    </li>
    <li>
      <a href="../articles/lab08_factorial.html">Lab 8: Factorial</a>
    </li>
    <li>
      <a href="../articles/lab09_nested.html">Lab 9: Nesting</a>
    </li>
    <li>
      <a href="../articles/lab10_splitplot.html">Lab 10: Split-plot design</a>
    </li>
    <li>
      <a href="../articles/lab11_repeated_measures.html">Lab 11: Repeated Measures</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework.html">Assignment instructions</a>
    </li>
    <li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/RMarkdown.html">R Markdown reference</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Creating publication-quality graphics</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 6: Assumptions of ANOVA</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2022</h4>
            
      
      
      <div class="hidden name"><code>lab06_assump_nonpar.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="assumptions-of-the-anova-model">Assumptions of the ANOVA model<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a><a class="anchor" aria-label="anchor" href="#assumptions-of-the-anova-model"></a>
</h2>
<p>All models have assumptions and knowing what those assumptions are,
and whether our data violate any of them, is crucial to the application
and interpretation of statistical models.</p>
<p>Before we get to the assumptions of ANOVA models, it may help to
re-parameterize the model a bit. Remember from lecture that we can write
the ANOVA model as:</p>
<p><span class="math display">\[\Large y_{ij} = \mu + \alpha_i +
\epsilon_{ij}\]</span></p>
<p><span class="math display">\[\Large \epsilon_{ij} \sim normal(0,
\sigma^2)\]</span></p>
<p>where</p>
<ul>
<li><p><span class="math inline">\(\mu\)</span> is the overall mean (the
horiztonal black line the below figure);</p></li>
<li><p><span class="math inline">\(\alpha_i\)</span> is the difference
between the overall mean and mean of group <span class="math inline">\(i\)</span> (the vertical orange, blue, and green,
lines in the below figure);</p></li>
<li><p><span class="math inline">\(\epsilon_{ij}\)</span> is the
difference between observation <span class="math inline">\(y_{ij}\)</span> and the mean of its group (also
known as <em>residual variation</em>; the vertical black lines in the
figure); and</p></li>
<li><p><span class="math inline">\(\sigma^2\)</span> is a measure of how
far, on average, each observation is from its group mean (the avarge
length of the black lines in the figure).</p></li>
</ul>
<p>Note that this is exactly the same as the ANOVA model, we’ve just
used some basic algebra to re-write it in different terms.</p>
<p><img src="lab06_assump_nonpar_files/figure-html/unnamed-chunk-2-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Let’s break down the above equations a bit further. First:</p>
<p><span class="math display">\[\Large E[y_{ij}] = \mu +
\alpha_i\]</span></p>
<p>this says that the expected value of observation <span class="math inline">\(y_{ij}\)</span> is <span class="math inline">\(\mu
+ \alpha_i\)</span>. That is, if we know what group an observation is
from, this is our best guess at what value it will take. In the figure,
this is the horizontal line (orange, blue, or green) for each group.</p>
<p>Next, we can re-write the model for observation <span class="math inline">\(y_{ij}\)</span> as:</p>
<p><span class="math display">\[\Large y_{ij} \sim normal(E[y_{ij}],
\sigma^2)\]</span></p>
<p>this says that the observations are normally distributed around the
corresponding group means.</p>
<div class="section level3">
<h3 id="anova-assumptions">ANOVA assumptions<a class="anchor" aria-label="anchor" href="#anova-assumptions"></a>
</h3>
<p>Now let’s look more specifically at the primary assumptions of this
model:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Normality</strong>:<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> The ANOVA model assumes that the residuals
(<span class="math inline">\(y_{ij} - E[y_{ij}]\)</span>) are normally
distributed. <em>Note that</em> 1) although we can formally test
normality (see below), we often assess this assumption based on the
nature of the data and statistical principles like the central limit
theorem<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>,
and 2) ANOVA results are pretty robust to minor violations of this
assumption, so we can often trust our results even when the residuals
are not normal.</li>
</ol>
<hr>
<p>Look at the equations above. Where does this assumption come from in
the model?</p>
<p>What are some biological processes that may lead to data that violate
this assumption?</p>
<hr>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Equality of variances</strong> (also known as
<em>homoscedasticity</em>): The ANOVA model also assumes that the
residual variance is the same for all groups. Another way to say this is
that the residual variance is independent of group/expected value.
Again, we can formally test this assumption (see lecture 3) and it’s
important to do so because it is often violated.</li>
</ol>
<hr>
<p>Look at the equations above. Where does this assumption come from in
the model?</p>
<p>What are some biological processes that may lead to data that violate
this assumption?</p>
<hr>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>Independence</strong>: The ANOVA model assumes that each
observation <span class="math inline">\(y_{ij}\)</span> is independent
of all other observations. This is actually an assumption of virtually
all models we will see this semester because it’s central to the way we
calculate the <em>likelihood</em> of observing our data (more on this
later). This assumption is a little harder to “see” in the model but
it’s nonetheless there. Testing for independence is tough, so usually we
assess this assumption based on our understanding of how the data were
generated and observed.</li>
</ol>
<hr>
<p>What are some biological processes that may lead to data that violate
this assumption?</p>
<hr>
</div>
<div class="section level3">
<h3 id="testing-the-assumptions">Testing the assumptions<a class="anchor" aria-label="anchor" href="#testing-the-assumptions"></a>
</h3>
<div class="section level4">
<h4 id="a-fake-dataset">A fake dataset<a class="anchor" aria-label="anchor" href="#a-fake-dataset"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"infectionRates"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">infectionRates</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    90 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ percentInfected: num  0.21 0.25 0.17 0.26 0.21 0.21 0.22 0.27 0.23 0.14 ...</span></span>
<span><span class="co">#&gt;  $ landscape      : chr  "Park" "Park" "Park" "Park" ...</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">infectionRates</span><span class="op">)</span></span>
<span><span class="co">#&gt;  percentInfected  landscape        </span></span>
<span><span class="co">#&gt;  Min.   :0.010   Length:90         </span></span>
<span><span class="co">#&gt;  1st Qu.:0.040   Class :character  </span></span>
<span><span class="co">#&gt;  Median :0.090   Mode  :character  </span></span>
<span><span class="co">#&gt;  Mean   :0.121                     </span></span>
<span><span class="co">#&gt;  3rd Qu.:0.210                     </span></span>
<span><span class="co">#&gt;  Max.   :0.330</span></span></code></pre></div>
<p>These data are made-up, but imagine they come from a study in which
100 crows are placed in n = 30 enclosures in each of 3 landscapes. The
response variable is the proportion of crows infected with West Nile
virus at the end of the study.</p>
<div class="section level5">
<h5 id="one-way-anova">One-way ANOVA<a class="anchor" aria-label="anchor" href="#one-way-anova"></a>
</h5>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anova1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">percentInfected</span> <span class="op">~</span> <span class="va">landscape</span>, data <span class="op">=</span> <span class="va">infectionRates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">anova1</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; landscape    2  0.638   0.319     306 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Residuals   87  0.091   0.001                   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Significant, but did we meet the assumptions?</p>
</div>
<div class="section level5">
<h5 id="visualizing-the-data">Visualizing the data<a class="anchor" aria-label="anchor" href="#visualizing-the-data"></a>
</h5>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">infectionRates</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">landscape</span>, y <span class="op">=</span> <span class="va">percentInfected</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"Percent infected"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab06_assump_nonpar_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Notice that the variances don’t look equal among groups.</p>
</div>
<div class="section level5">
<h5 id="visualizing-the-residuals">Visualizing the residuals<a class="anchor" aria-label="anchor" href="#visualizing-the-residuals"></a>
</h5>
<p>Histogram of residuals</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">anova1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">resids</span>, col<span class="op">=</span><span class="st">"turquoise"</span>, breaks<span class="op">=</span><span class="fl">10</span>, xlab<span class="op">=</span><span class="st">"Residuals"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab06_assump_nonpar_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<p>QQ-plot of the residuals</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">anova1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">geom_qq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_qq.html" class="external-link">geom_qq_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab06_assump_nonpar_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The histogram doesn’t look bad, but the QQ-plot suggests the smallest
residuals are smaller than expected (below the QQ line) and the large
residuals are bigger than expected (above the QQ line). We can also
formally test the normality assumption using the Shapiro-Wilk test.</p>
</div>
<div class="section level5">
<h5 id="normality-test-on-residuals">Normality test on residuals<a class="anchor" aria-label="anchor" href="#normality-test-on-residuals"></a>
</h5>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="va">resids</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Shapiro-Wilk normality test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  resids</span></span>
<span><span class="co">#&gt; W = 0.96, p-value = 0.004</span></span></code></pre></div>
<p>We reject the null hypothesis that the residuals come from a normal
distribution.</p>
<p>Clearly, we have violated both the normality and equality of variance
assumptions. Since we failed to meet the key assumptions of ANOVA, we
should consider transformations and/or non-parametric tests.</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="transformations">Transformations<a class="anchor" aria-label="anchor" href="#transformations"></a>
</h2>
<p>One way to move forward with our analysis when assumptions are
violated is to transform the response data. In some cases, simple
transformations can help us meet assumptions. Knowing which
transformation to use in which context requires some experience, and we
have to keep in mind that the interpretation of the model parameters
changes a bit. However, a good “toolkit” of standard transformations can
often get you pretty far, so let’s look at a few standard choices:</p>
<div class="section level4">
<h4 id="logarithmic-transformation">Logarithmic transformation<a class="anchor" aria-label="anchor" href="#logarithmic-transformation"></a>
</h4>
<p><span class="math display">\[\Large y = log(u + C)\]</span></p>
<ul>
<li><p><span class="math inline">\(y\)</span> is the transformed
response variable</p></li>
<li><p><span class="math inline">\(u\)</span> is original response
variable</p></li>
<li><p>The constant <span class="math inline">\(C\)</span> is often 1 if
there are zeros in the data</p></li>
</ul>
<p><strong>Useful when group variances are proportional to the
means</strong></p>
<p>Here’s what the infection rate data looks like when log
transformed:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">infectionRates</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">landscape</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">percentInfected</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"log(Percent infected)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab06_assump_nonpar_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="square-root-transformation">Square root transformation<a class="anchor" aria-label="anchor" href="#square-root-transformation"></a>
</h4>
<p><span class="math display">\[\Large y = \sqrt{u + C}\]</span></p>
<ul>
<li>
<span class="math inline">\(C\)</span> is often 0.5 or some other
small number</li>
</ul>
<p><strong>Useful when group variances are proportional to the
means</strong></p>
<p>Here’s what the infection rate data looks like when square root
transformed:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">infectionRates</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">landscape</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">percentInfected</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"sqrt(Percent infected)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab06_assump_nonpar_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="arcsine-square-root-transformation">Arcsine-square root transformation<a class="anchor" aria-label="anchor" href="#arcsine-square-root-transformation"></a>
</h4>
<p><span class="math display">\[\Large y = arcsin(\sqrt{u})\]</span></p>
<ul>
<li>logit transformation is an alternative: <span class="math inline">\(y = log\big(\frac{u}{1−u}\big)\)</span>
</li>
</ul>
<p><strong>Used on proportions</strong></p>
<p>Here’s what the infection rate data looks like when arcsine-square
root transformed:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">infectionRates</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">landscape</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">asin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">percentInfected</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"arcsin(sqrt(Percent infected)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab06_assump_nonpar_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="reciprocal-transformation">Reciprocal Transformation<a class="anchor" aria-label="anchor" href="#reciprocal-transformation"></a>
</h4>
<p><span class="math display">\[\Large y = \frac{1}{u + C}\]</span></p>
<ul>
<li>
<span class="math inline">\(C\)</span> is often 1 but could be 0 if
there are no zeros in <span class="math inline">\(u\)</span>
</li>
</ul>
<p><strong>Useful when group SDs are proportional to the squared group
means</strong></p>
<p>Here’s what the infection rate data looks like when reciprocally
transformed:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">infectionRates</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">landscape</span>, y <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">percentInfected</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span><span class="st">"1/Percent infected)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab06_assump_nonpar_files/figure-html/unnamed-chunk-12-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="anova-on-transformed-data">ANOVA on transformed data<a class="anchor" aria-label="anchor" href="#anova-on-transformed-data"></a>
</h3>
<p>Transformation can be done in the <code>aov</code> formula:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anova2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">percentInfected</span><span class="op">)</span> <span class="op">~</span> <span class="va">landscape</span>, data <span class="op">=</span> <span class="va">infectionRates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">anova2</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; landscape    2   60.9    30.5     304 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; Residuals   87    8.7     0.1                   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The log transformation didn’t help much: We still reject the
normality assumption</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html" class="external-link">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">resid</a></span><span class="op">(</span><span class="va">anova2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Shapiro-Wilk normality test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  resid(anova2)</span></span>
<span><span class="co">#&gt; W = 0.97, p-value = 0.04</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="non-parametric-models">Non-parametric models<a class="anchor" aria-label="anchor" href="#non-parametric-models"></a>
</h2>
<p>Occasionally, transformations will not be sufficient or appropriate
for meeting the ANOVA assumptions. In this case, we can use models that
do not make assumptions about the distribution on the residuals, termed
<em>non-parametric models</em>.</p>
<p>One such test is the Wilcoxan rank sum test:</p>
<ul>
<li><p>For 2 group comparisons (alternative to <em>t</em>-test)</p></li>
<li><p>a.k.a. the Mann-Whitney <span class="math inline">\(U\)</span>
test</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test()</a></code></p></li>
</ul>
<p>Another is the Kruskal-Wallis One-Way ANOVA</p>
<ul>
<li><p>For testing differences in &gt; 2 groups</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/kruskal.test.html" class="external-link">kruskal.test()</a></code></p></li>
</ul>
<p>These two functions can be used in almost the exact same way as
<code><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test()</a></code> and <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code>, respectively.</p>
</div>
<div class="section level2">
<h2 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h2>
<p>Create an R Markdown file to do the following:</p>
<ol style="list-style-type: decimal">
<li>Create an <code>R</code> chunk to load the data using:</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"infectionRates"</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Create a header called “ANOVA on transformed data”. Within this
section, decide which transformation is best for the
<code>infectionRates</code> data by conducting ANOVAs using the log,
square-root, arcsine square-root, and reciprocal transformations. Use
boxplots, histograms, and Shapiro’s tests to determine the best
transformation.</li>
</ol>
<p>Within this section, use subheaders to delineate different
transformations. At this point in the semester, your figures should be
starting to look more professional so <strong>take time to make them
look nice</strong> and <strong>include captions</strong> (see
<code>fig.caption</code> chunk option). Look over the “Creating
publication-quality graphics” reference for additional tips. Also
include a subheader within which you <strong>write a short
conclusion</strong> about which transformation you think is best for
these data.</p>
<ol start="3" style="list-style-type: decimal">
<li><p>Within the section with your conclusion about which
transformation to use, discuss whether the transformation alters the
conclusion about the null hypothesis of no difference in means? If not,
were the transformations necessary?</p></li>
<li><p>Create a header called “Non-parametric test”. In this section,
conduct a Kruskal-Wallis test on the data. What is the conclusion?
Explain your answers.</p></li>
</ol>
<p>A few things to remember when creating the assignment:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Title the document:
<code>title: "Homework 2: Assumptions and transformations"</code></p></li>
<li><p>Be sure to include your first and last name in the
<code>author</code> section</p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks so we can see both your code and the output</p></li>
<li><p>Please upload both the <code>html</code> and <code>.Rmd</code>
files when you submit your assignment</p></li>
<li><p>See the R Markdown reference sheet for help with creating
<code>R</code> chunks, equations, tables, etc.</p></li>
<li><p>See the “Creating publication-quality graphics” reference sheet
for tips on formatting figures</p></li>
</ul>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Because we can view the <em>t</em>-test as a special
case of an ANOVA (one with only 2 groups), these assumptions also apply
to <em>t</em>-tests!<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>It’s important to note that this assumption applies to
the <em>residuals</em>, not the response data itself. This is a common
misconception<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>CLT<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
