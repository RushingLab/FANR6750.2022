<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 9: Split plot designs • FANR6750</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 9: Split plot designs">
<meta property="og:description" content="FANR6750">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FANR6750</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2021.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/01_basic_stats/01_basic_stats.html">Lecture 1: Basic concepts in statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/02_t-tests/02_t-tests.html">Lecture 2: t-tests</a>
    </li>
    <li>
      <a href="../articles/lectures/03_anova/03_anova.html">Lecture 3: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/04_mult_comparisons/04_mult_comparisons.html">Lecture 4: Multiple comparisons</a>
    </li>
    <li>
      <a href="../articles/lectures/05_contrasts/05_contrasts.html">Lecture 5: Contrasts</a>
    </li>
    <li>
      <a href="../articles/lectures/06_power-analysis/06_power-analysis.html">Lecture 6: Power analysis</a>
    </li>
    <li>
      <a href="../articles/lectures/07_estimation/07_estimation.html">Lecture 7: Estimation</a>
    </li>
    <li>
      <a href="../articles/lectures/08_assumptions/08_assumptions.html">Lecture 8: ANOVA assumptions</a>
    </li>
    <li>
      <a href="../articles/lectures/09_nonparametrics/09_nonparametrics.html">Lecture 9: Non-parametric statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/10_blocking/10_blocking.html">Lecture 10: Blocking</a>
    </li>
    <li>
      <a href="../articles/lectures/11_raneff/11_raneff.html">Lecture 11: Random effects</a>
    </li>
    <li>
      <a href="../articles/lectures/12_factorial/12_factorial.html">Lecture 12: Factorial designs</a>
    </li>
    <li>
      <a href="../articles/lectures/13_nesting/13_nesting.html">Lecture 13: Nested designs</a>
    </li>
    <li>
      <a href="../articles/lectures/14_splitplot/14_splitplot.html">Lecture 14: Split plot designs</a>
    </li>
    <li>
      <a href="../articles/lectures/15_repeated_measures/15_repeated_measures.html">Lecture 15: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lectures/16_ANCOVA/16_ANCOVA.html">Lecture 16: ANCOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/17_lm/17_lm.html">Lecture 17: Linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/18_glm/18_glm.html">Lecture 18: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/lectures/19_model_selection/19_model_selection.html">Lecture 19: Model selection</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab01_Intro_to_R.html">Lab 1: Introduction to R</a>
    </li>
    <li>
      <a href="../articles/lab02_t-tests.html">Lab 2: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab03_ANOVA.html">Lab 3: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab04_contrasts.html">Lab 4: Contrasts, estimation, and power analysis</a>
    </li>
    <li>
      <a href="../articles/lab05_assump_nonpar.html">Lab 5: Assumptions of ANOVA, tranformations, and non-parametric tests</a>
    </li>
    <li>
      <a href="../articles/lab06_blocking.html">Lab 6: Randomized Complete Block Design</a>
    </li>
    <li>
      <a href="../articles/lab07_factorial.html">Lab 7: Factorial designs</a>
    </li>
    <li>
      <a href="../articles/lab08_nested.html">Lab 8: Nested ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab09_splitplot.html">Lab 9: Split plot designs</a>
    </li>
    <li>
      <a href="../articles/lab10_repeated_measures.html">Lab 10: Repeated measures</a>
    </li>
    <li>
      <a href="../articles/lab11_ANCOVA.html">Lab 11: ANCOVA</a>
    </li>
    <li>
      <a href="../articles/lab12_lm.html">Lab 12: Linear models</a>
    </li>
    <li>
      <a href="../articles/lab13_glm.html">Lab 13: Generalized linear models</a>
    </li>
    <li>
      <a href="../articles/lab14_model_selection.html">Lab 14: Model selection and multi-model inference</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework.html">Assignment instructions</a>
    </li>
    <li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/Rmarkdown.html">R Markdown reference</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="lab09_splitplot_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 9: Split plot designs</h1>
            <h3 class="subtitle">FANR 6750: Experimental Methods in Forestry and Natural Resources Research</h3>
                        <h4 class="author">Fall 2021</h4>
            
      
      
      <div class="hidden name"><code>lab09_splitplot.Rmd</code></div>

    </div>

    
    
<div id="scenario" class="section level1">
<h1 class="hasAnchor">
<a href="#scenario" class="anchor"></a>Scenario</h1>
<p>Remember from lecture that split-plot designs are used when we apply treatments to two experimental units: whole-units and sub-units</p>
<p>For example</p>
<ul>
<li><p>Ag fields are sprayed with herbicides, and fertilizers are applied to plots within fields</p></li>
<li><p>Tenderizer is applied to roasts, and cooking times are applied to cores</p></li>
</ul>
<p>In these cases, we’re interested in treatment effects at <strong>both</strong> levels</p>
<div id="the-additive-model" class="section level2">
<h2 class="hasAnchor">
<a href="#the-additive-model" class="anchor"></a>The additive model</h2>
<p>We can write the split plot model as:</p>
<p><span class="math display">\[\Large y_{ijk} = \mu + \alpha_i + \beta_j + \alpha \beta_{ij} + \gamma_k + \delta_{ik} + \epsilon_{ijk}\]</span> The <span class="math inline">\(\alpha\)</span>’s and <span class="math inline">\(\beta\)</span>’s are fixed treatment effects. Note the interaction.</p>
<p>Because we want our inferences to apply to all whole units (e.g., roasts), <span class="math inline">\(\delta_{ik}\)</span> is random. Specifically:</p>
<p><span class="math display">\[\Large \delta_{ik} \sim normal(0, \sigma^2_D)\]</span></p>
<p>We might view block (e.g. carcass) as random too:</p>
<p><span class="math display">\[\Large \gamma_k \sim normal(0, \sigma^2_C)\]</span></p>
<p>And as always,</p>
<p><span class="math display">\[\Large \epsilon_{ijk} \sim normal(0, \sigma^2)\]</span></p>
</div>
<div id="example-the-meat-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-the-meat-data" class="anchor"></a>Example: The meat data</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"meatData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">meatData</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    72 obs. of  5 variables:</span>
<span class="co">#&gt;  $ Wbscore   : num  8.25 7.5 4.25 3.5 7.25 6.25 3.5 3.5 6.5 4.5 ...</span>
<span class="co">#&gt;  $ tenderizer: chr  "C" "C" "C" "C" ...</span>
<span class="co">#&gt;  $ time      : int  30 36 42 48 30 36 42 48 30 36 ...</span>
<span class="co">#&gt;  $ carcass   : int  1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ roast     : int  1 1 1 1 2 2 2 2 3 3 ...</span></code></pre></div>
<p>As we’ve done with other examples, we need to convert each predictor to a factor (in this case, converting to factors is necessary to use the <code><a href="https://rdrr.io/pkg/multcomp/man/glht.html">mcp()</a></code> function, later in the analysis):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">meatData</span><span class="op">$</span><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">meatData</span><span class="op">$</span><span class="va">time</span><span class="op">)</span>
<span class="va">meatData</span><span class="op">$</span><span class="va">carcass</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">meatData</span><span class="op">$</span><span class="va">carcass</span><span class="op">)</span>
<span class="va">meatData</span><span class="op">$</span><span class="va">roast</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">meatData</span><span class="op">$</span><span class="va">roast</span><span class="op">)</span>
<span class="va">meatData</span><span class="op">$</span><span class="va">tenderizer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">meatData</span><span class="op">$</span><span class="va">tenderizer</span><span class="op">)</span></code></pre></div>
<hr>
<p>What does it mean to treat time as a factor? How would you interpret the results from a model that treated time as a continuous predictor vs a factor?</p>
<hr>
<p>Notice that all the roast column does is enumerate the tenderizer × carcass combinations (which explains why the corresponding term in the additive model is <span class="math inline">\(\delta_{ik}\)</span>):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">meatData</span>, n<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;    Wbscore tenderizer time carcass roast</span>
<span class="co">#&gt; 1     8.25          C   30       1     1</span>
<span class="co">#&gt; 2     7.50          C   36       1     1</span>
<span class="co">#&gt; 3     4.25          C   42       1     1</span>
<span class="co">#&gt; 4     3.50          C   48       1     1</span>
<span class="co">#&gt; 5     7.25          V   30       1     2</span>
<span class="co">#&gt; 6     6.25          V   36       1     2</span>
<span class="co">#&gt; 7     3.50          V   42       1     2</span>
<span class="co">#&gt; 8     3.50          V   48       1     2</span>
<span class="co">#&gt; 9     6.50          P   30       1     3</span>
<span class="co">#&gt; 10    4.50          P   36       1     3</span></code></pre></div>
</div>
<div id="carcass-block-effects-as-fixed" class="section level2">
<h2 class="hasAnchor">
<a href="#carcass-block-effects-as-fixed" class="anchor"></a>Carcass (block) effects as fixed</h2>
<p>Only one <code><a href="https://rdrr.io/r/stats/aov.html">Error()</a></code> term allowed in <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>, so treat block effect as fixed:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aov.meat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Wbscore</span> <span class="op">~</span> <span class="va">tenderizer</span> <span class="op">*</span> <span class="va">time</span> <span class="op">+</span> <span class="va">carcass</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">Error</a></span><span class="op">(</span><span class="va">roast</span><span class="op">)</span>, 
                data <span class="op">=</span> <span class="va">meatData</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">aov.meat</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: roast</span>
<span class="co">#&gt;            Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span>
<span class="co">#&gt; tenderizer  2  20.72   10.36   190.0 1.1e-08 ***</span>
<span class="co">#&gt; carcass     5   3.90    0.78    14.3 0.00028 ***</span>
<span class="co">#&gt; Residuals  10   0.55    0.05                    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: Within</span>
<span class="co">#&gt;                 Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span>
<span class="co">#&gt; time             3  170.1    56.7   656.6 &lt; 2e-16 ***</span>
<span class="co">#&gt; tenderizer:time  6    9.6     1.6    18.5 1.1e-10 ***</span>
<span class="co">#&gt; Residuals       45    3.9     0.1                    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
</div>
<div id="using-lme-instead-of-aov" class="section level2">
<h2 class="hasAnchor">
<a href="#using-lme-instead-of-aov" class="anchor"></a>Using <code>lme()</code> instead of <code>aov()</code>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/nlme/">nlme</a></span><span class="op">)</span>
<span class="va">lme.meat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span><span class="va">Wbscore</span> <span class="op">~</span> <span class="va">tenderizer</span> <span class="op">*</span> <span class="va">time</span>,
                data <span class="op">=</span> <span class="va">meatData</span>,
                correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corCompSymm.html">corCompSymm</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># To make results same as aov()</span>
                random <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">carcass</span><span class="op">/</span><span class="va">roast</span><span class="op">)</span></code></pre></div>
<p>The first row of the ANOVA table is for the (Intercept) term, which we can ignore here (hence the <code>[-1,]</code> indexing operation):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lme.meat</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span>
<span class="co">#&gt;                 numDF denDF F-value p-value</span>
<span class="co">#&gt; tenderizer          2    10   190.0  &lt;.0001</span>
<span class="co">#&gt; time                3    45   656.6  &lt;.0001</span>
<span class="co">#&gt; tenderizer:time     6    45    18.5  &lt;.0001</span></code></pre></div>
<div id="exploring-interaction" class="section level3">
<h3 class="hasAnchor">
<a href="#exploring-interaction" class="anchor"></a>Exploring interaction</h3>
<p>Is the time effect significant for each level of tenderizer?</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lme.meatP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span><span class="va">Wbscore</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">meatData</span>,
                 random <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">carcass</span><span class="op">/</span><span class="va">roast</span>, 
                 correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corCompSymm.html">corCompSymm</a></span><span class="op">(</span><span class="op">)</span>,
                 subset <span class="op">=</span> <span class="va">tenderizer</span><span class="op">==</span><span class="st">"P"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lme.meatP</span>, Terms <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span>
<span class="co">#&gt; F-test for: time </span>
<span class="co">#&gt;   numDF denDF F-value p-value</span>
<span class="co">#&gt; 1     3    15   126.7  &lt;.0001</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lme.meatV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span><span class="va">Wbscore</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">meatData</span>,
                 random <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">carcass</span><span class="op">/</span><span class="va">roast</span>, 
                 correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corCompSymm.html">corCompSymm</a></span><span class="op">(</span><span class="op">)</span>,
                 subset <span class="op">=</span> <span class="va">tenderizer</span><span class="op">==</span><span class="st">"V"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lme.meatV</span>, Terms <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span>
<span class="co">#&gt; F-test for: time </span>
<span class="co">#&gt;   numDF denDF F-value p-value</span>
<span class="co">#&gt; 1     3    15   274.7  &lt;.0001</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lme.meatC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span><span class="op">(</span><span class="va">Wbscore</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">meatData</span>, 
                 random <span class="op">=</span> <span class="op">~</span><span class="fl">1</span><span class="op">|</span><span class="va">carcass</span><span class="op">/</span><span class="va">roast</span>, 
                 correlation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/corCompSymm.html">corCompSymm</a></span><span class="op">(</span><span class="op">)</span>,
                 subset <span class="op">=</span> <span class="va">tenderizer</span><span class="op">==</span><span class="st">"C"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">lme.meatC</span>, Terms <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span>
<span class="co">#&gt; F-test for: time </span>
<span class="co">#&gt;   numDF denDF F-value p-value</span>
<span class="co">#&gt; 1     3    15   305.7  &lt;.0001</span></code></pre></div>
<p>Yes it is.</p>
</div>
</div>
<div id="multiple-comparisons-using-glht-package-multcomp" class="section level2">
<h2 class="hasAnchor">
<a href="#multiple-comparisons-using-glht-package-multcomp" class="anchor"></a>Multiple comparisons using <code>glht()</code> (package <code>multcomp</code>)</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org">multcomp</a></span><span class="op">)</span>
<span class="va">mcP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht</a></span><span class="op">(</span><span class="va">lme.meatP</span>, linfct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">mcp</a></span><span class="op">(</span>time<span class="op">=</span><span class="st">"Tukey"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mcP</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Simultaneous Tests for General Linear Hypotheses</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Multiple Comparisons of Means: Tukey Contrasts</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit: lme.formula(fixed = Wbscore ~ time, data = meatData, random = ~1 | </span>
<span class="co">#&gt;     carcass/roast, correlation = corCompSymm(), subset = tenderizer == </span>
<span class="co">#&gt;     "P")</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Linear Hypotheses:</span>
<span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="co">#&gt; 36 - 30 == 0    -1.25       0.18   -6.94   &lt;1e-05 ***</span>
<span class="co">#&gt; 42 - 30 == 0    -2.33       0.18  -12.96   &lt;1e-05 ***</span>
<span class="co">#&gt; 48 - 30 == 0    -3.33       0.18  -18.52   &lt;1e-05 ***</span>
<span class="co">#&gt; 42 - 36 == 0    -1.08       0.18   -6.02   &lt;1e-05 ***</span>
<span class="co">#&gt; 48 - 36 == 0    -2.08       0.18  -11.57   &lt;1e-05 ***</span>
<span class="co">#&gt; 48 - 42 == 0    -1.00       0.18   -5.55   &lt;1e-05 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co">#&gt; (Adjusted p values reported -- single-step method)</span></code></pre></div>
<p>We can also easily plot the differences between cooking times for “P” tenderizer (and for the other 2 levels of tenderizer as well)</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mcP</span><span class="op">)</span></code></pre></div>
<p><img src="lab09_splitplot_files/figure-html/unnamed-chunk-11-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="nested-and-crossed-example" class="section level1">
<h1 class="hasAnchor">
<a href="#nested-and-crossed-example" class="anchor"></a>Nested and crossed example</h1>
<p>Nested-and-crossed is same as split-plot, but without the block. For example:</p>
<ul>
<li><p>Sweet potato yield is studied in response to (<span class="math inline">\(a=3\)</span>) types of herbicide.</p></li>
<li><p>Each herbicide is applied to 5 fields</p></li>
<li><p>Each field is divided into 4 plots. Each plot is treated with one of (<span class="math inline">\(b=4\)</span>) fertilizers.</p></li>
</ul>
<div id="assignment" class="section level2">
<h2 class="hasAnchor">
<a href="#assignment" class="anchor"></a>Assignment</h2>
<p>The data can be accessed using:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"yieldData"</span><span class="op">)</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Conduct the appropriate ANOVA using <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> and <code><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme()</a></code></p></li>
<li><p>Give the appropriate additive model (this will be slightly different than the one for the split-plot design, since there is no blocking). What are the associated null and alternative hypotheses?</p></li>
<li><p>Does the effect of herbicide depend on fertilizer?</p></li>
<li><p>Use Tukey’s test to determine which fertilizers differ</p></li>
</ol>
<p>Put your answers in an R Markdown report. Your report should include:</p>
<ol style="list-style-type: decimal">
<li><p>A well-formatted ANOVA table (with caption); and</p></li>
<li><p>A publication-quality plot (or plots) of the estimated effect of herbicide and fertilizer on yield, including 95% confidence intervals. The figure should also have a descriptive caption and any aesthetics (color, line type, etc.) should be clearly defined.</p></li>
</ol>
<p>You may format the report however you like but it should be well-organized, with relevant headers, plain text, and the elements described above.</p>
<p>As always:</p>
<ul>
<li><p>Be sure the output type is set to: <code>output: html_document</code></p></li>
<li><p>Title the document: <code>title: "Lab 9 assignment"</code></p></li>
<li><p>Be sure to include your first and last name in the <code>author</code> section</p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code> chunks so we can see both your code and the output</p></li>
<li><p>Please upload both the <code>html</code> and <code>.Rmd</code> files when you submit your assignment</p></li>
<li><p>See the R Markdown reference sheet for help with creating <code>R</code> chunks, equations, tables, etc.</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
