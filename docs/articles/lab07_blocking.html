<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lab 7: Randomized Complete Block Design • FANR6750</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lab 7: Randomized Complete Block Design">
<meta property="og:description" content="FANR6750">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FANR6750</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2022.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/syllabus.html">
    <span class="fas fa-book"></span>
     
    Syllabus
  </a>
</li>
<li>
  <a href="../articles/schedule.html">
    <span class="fas fa-calendar"></span>
     
    Schedule
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file-pdf-o"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lectures/00_course_intro/00_course_intro.html">Lecture 0: Course introduction</a>
    </li>
    <li>
      <a href="../articles/lectures/01_basic_stats/01_basic_stats.html">Lecture 1: Basic concepts in statistics</a>
    </li>
    <li>
      <a href="../articles/lectures/02_estimation/02_estimation.html">Lecture 2: Principles of Estimation</a>
    </li>
    <li>
      <a href="../articles/lectures/03_models/03_models.html">Lecture 3: Introduction to Statistical Modeling</a>
    </li>
    <li>
      <a href="../articles/lectures/04_NHST/04_NHST.html">Lecture 4: t-tests and Null Hypothesis Testing</a>
    </li>
    <li>
      <a href="../articles/lectures/05_anova/05_anova.html">Lecture 5: One-way ANOVA</a>
    </li>
    <li>
      <a href="../articles/lectures/06_mult_comparisons/06_mult_comparisons.html">Lecture 6: Multiple Comparisons</a>
    </li>
    <li>
      <a href="../articles/lectures/07_contrasts/07_contrasts.html">Lecture 7: Contrasts</a>
    </li>
    <li>
      <a href="../articles/lectures/08_power-analysis/08_power-analysis.html">Lecture 8: Power Analysis</a>
    </li>
    <li>
      <a href="../articles/lectures/09_assumptions/09_assumptions.html">Lecture 9: Assumptions and transformations</a>
    </li>
    <li>
      <a href="../articles/lectures/10_estimation/10_estimation.html">Lecture 10: Confidence intervals</a>
    </li>
    <li>
      <a href="../articles/lectures/11_blocking/11_blocking.html">Lecture 11: Blocking</a>
    </li>
    <li>
      <a href="../articles/lectures/12_raneff/12_raneff.html">Lecture 12: Random effects</a>
    </li>
    <li>
      <a href="../articles/lectures/13_factorial/13_factorial.html">Lecture 13: Factorial designs</a>
    </li>
    <li>
      <a href="../articles/lectures/14_nesting/14_nesting.html">Lecture 14: Nested effects</a>
    </li>
    <li>
      <a href="../articles/lectures/15_splitplot/15_splitplot.html">Lecture 15: Split-plot designs</a>
    </li>
    <li>
      <a href="../articles/lectures/16_repeated_measures/16_repeated_measures.html">Lecture 16: Repeated measures</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-desktop"></span>
     
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/lab01_Intro_to_R.html">Lab 1: Introduction to R</a>
    </li>
    <li>
      <a href="../articles/lab02_Intro_project_and_Rmd.html">Lab 2: Introduction to RMarkdown and Projects</a>
    </li>
    <li>
      <a href="../articles/lab03_t-tests.html">Lab 3: t-tests</a>
    </li>
    <li>
      <a href="../articles/lab04_ANOVA.html">Lab 4: ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab05_contrasts.html">Lab 5: Contrasts</a>
    </li>
    <li>
      <a href="../articles/lab06_assump_nonpar.html">Lab 6: Assumptions of ANOVA</a>
    </li>
    <li>
      <a href="../articles/lab07_blocking.html">Lab 7: Blocking</a>
    </li>
    <li>
      <a href="../articles/lab08_factorial.html">Lab 8: Factorial</a>
    </li>
    <li>
      <a href="../articles/lab09_nested.html">Lab 9: Nesting</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-pencil-square-o"></span>
     
    References
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/homework.html">Assignment instructions</a>
    </li>
    <li>
      <a href="../articles/projects_and_directories.html">Projects and directories</a>
    </li>
    <li>
      <a href="../articles/RMarkdown.html">R Markdown reference</a>
    </li>
    <li>
      <a href="../articles/graphics.html">Creating publication-quality graphics</a>
    </li>
  </ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Lab 7: Randomized Complete Block Design</h1>
            <h3 data-toc-skip class="subtitle">FANR 6750: Experimental
Methods in Forestry and Natural Resources Research</h3>
                        <h4 data-toc-skip class="author">Fall 2022</h4>
            
      
      
      <div class="hidden name"><code>lab07_blocking.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="recap">Recap<a class="anchor" aria-label="anchor" href="#recap"></a>
</h2>
<p>Remember from lecture that randomized complete block design (RCBD) is
like one-way ANOVA except experimental units are organized into blocks
to account for extraneous source of variation.</p>
<p>Blocks can be regions, time periods, individual subjects, etc. but
blocking must occur <strong>during the design phase</strong> of the
study.</p>
<p>We can write the additive RCBD model as:</p>
<p><span class="math display">\[\large y_{ij} = \mu + \alpha_i + \beta_j
+ \epsilon_{ij}\]</span></p>
</div>
<div class="section level2">
<h2 id="blocked-anova-by-hand">Blocked ANOVA by hand<a class="anchor" aria-label="anchor" href="#blocked-anova-by-hand"></a>
</h2>
<p>To “fit” the RCBD model by hand, we’ll use the gypsy moth data we saw
in lecture:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mothData"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mothData</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="center">Treatment</th>
<th align="center">Region</th>
<th align="center">caterpillar</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Control</td>
<td align="center">1</td>
<td align="center">25</td>
</tr>
<tr class="even">
<td align="center">Control</td>
<td align="center">2</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="center">Control</td>
<td align="center">3</td>
<td align="center">15</td>
</tr>
<tr class="even">
<td align="center">Control</td>
<td align="center">4</td>
<td align="center">32</td>
</tr>
<tr class="odd">
<td align="center">Bt</td>
<td align="center">1</td>
<td align="center">16</td>
</tr>
<tr class="even">
<td align="center">Bt</td>
<td align="center">2</td>
<td align="center">3</td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="factors">Factors<a class="anchor" aria-label="anchor" href="#factors"></a>
</h3>
<p>So far, we have generally treated data as either numeric/integer if
the vector consisted of numbers, or character if the data consisted of
non-numeric information. To perform the RCBD analysis, we need to learn
about another type of object in <code>R</code> - factors.</p>
<p>Factors look like character strings but they behave quite
differently, and understanding the way that <code>R</code> handles
factors is key to working this type of data. The key difference between
factors and character strings is that factors are used to represent
<em>categorical</em> data with a fixed number of possible values, called
<em>levels</em><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>Factors can be created using the <code><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"adult"</span>, <span class="st">"juvenile"</span>, <span class="st">"adult"</span>, <span class="st">"juvenile"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Because we didn’t explicitly tell <code>R</code> the levels of this
factor, it will assume the levels are <em>adult</em> and
<em>juvenile</em>. Furthermore, by default <code>R</code> assigns levels
in alphabetical order, so <code>adult</code> will be the first level and
<code>juvenile</code> will be the second level:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "adult"    "juvenile"</span></span></code></pre></div>
<p>Sometimes alphabetical order might not make sense:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"medium"</span>, <span class="st">"low"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<hr>
<p>What order will <code>R</code> assign to the treatment levels?</p>
<hr>
<p>If you want to order the factor in a different way, you can use the
optional <code>levels</code> argument:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "low"    "medium" "high"</span></span></code></pre></div>
<p>Sometimes you may also need to remove factor levels. For example,
let’s see what happens if we have a type in one of the factors:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"Male"</span>, <span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab07_blocking_files/figure-html/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Oops, one of the field techs accidentally capitalized “Male”. Let’s
change that to lowercase:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span><span class="op">[</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"Male"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"male"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab07_blocking_files/figure-html/unnamed-chunk-7-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Hmm, there’s still a bar for <code>Male</code>. We can see what’s
happening here by looking at the levels:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "female" "male"   "Male"</span></span></code></pre></div>
<p>Removing/editing the factors doesn’t change the levels! So
<code>R</code> still thinks there are three levels, just zero
<code>Male</code> entries. To remove that mis-specified level, we need
to drop it:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="lab07_blocking_files/figure-html/unnamed-chunk-9-1.png" width="384" style="display: block; margin: auto;"></p>
<p>That’s better.</p>
<p>The bottom line is be careful when working with factors, since their
behavior is not always intuitive. There are more great online resources
for working with factors in <code>R</code>, including <a href="https://swcarpentry.github.io/r-novice-inflammation/12-supp-factors/" class="external-link">this
tutorial</a> and even a package (<a href="https://forcats.tidyverse.org/" class="external-link">forcats</a>) that tries to make it
a bit easier.</p>
</div>
<div class="section level3">
<h3 id="back-to-the-data">Back to the data<a class="anchor" aria-label="anchor" href="#back-to-the-data"></a>
</h3>
<p>Before we analyze the moth data, we need to tell <code>R</code> to
treat the <code>Treatment</code> and <code>Plot</code> variables as
factors:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mothData</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    12 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ Treatment  : chr  "Control" "Control" "Control" "Control" ...</span></span>
<span><span class="co">#&gt;  $ Region     : int  1 2 3 4 1 2 3 4 1 2 ...</span></span>
<span><span class="co">#&gt;  $ caterpillar: num  25 10 15 32 16 3 10 18 14 2 ...</span></span></code></pre></div>
<p>Right now, they are character and integer objects, respectively.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mothData</span><span class="op">$</span><span class="va">Treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mothData</span><span class="op">$</span><span class="va">Treatment</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Bt"</span>, <span class="st">"Dimilin"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">mothData</span><span class="op">$</span><span class="va">Treatment</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Control" "Bt"      "Dimilin"</span></span>
<span></span>
<span><span class="va">mothData</span><span class="op">$</span><span class="va">Region</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">mothData</span><span class="op">$</span><span class="va">Region</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">mothData</span><span class="op">$</span><span class="va">Region</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "1" "2" "3" "4"</span></span></code></pre></div>
<p>Note that we were explicit about the order of levels for
<code>Treatment</code> so that controls came first.</p>
<div class="section level4">
<h4 id="means">Means<a class="anchor" aria-label="anchor" href="#means"></a>
</h4>
<p>Next, compute the means:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Grand mean</span></span>
<span><span class="op">(</span><span class="va">grand.mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mothData</span><span class="op">$</span><span class="va">caterpillar</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 14.42</span></span>
<span></span>
<span><span class="co"># Treatment means</span></span>
<span><span class="op">(</span><span class="va">treatment.means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">mothData</span>, <span class="va">Treatment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">caterpillar</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 2</span></span></span>
<span><span class="co">#&gt;   Treatment    mu</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Control    20.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Bt         11.8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Dimilin    11</span></span>
<span></span>
<span><span class="co"># Block means</span></span>
<span><span class="op">(</span><span class="va">block.means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">mothData</span>, <span class="va">Region</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">caterpillar</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   Region    mu</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1       18.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2        5  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3       13.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 4       20.7</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="treatment-sums-of-squares">Treatment sums of squares<a class="anchor" aria-label="anchor" href="#treatment-sums-of-squares"></a>
</h4>
<p>Remember the formula for the treatment sums of squares</p>
<p><span class="math display">\[\Large b \times \sum_{i=1}^a (\bar{y}_i
- \bar{y}_.)^2\]</span></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">mothData</span><span class="op">$</span><span class="va">Region</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">SS.treat</span> <span class="op">&lt;-</span> <span class="va">b</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">treatment.means</span><span class="op">$</span><span class="va">mu</span> <span class="op">-</span> <span class="va">grand.mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 223.2</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="block-sums-of-squares">Block sums of squares<a class="anchor" aria-label="anchor" href="#block-sums-of-squares"></a>
</h4>
<p>The formula for the block sums of squares</p>
<p><span class="math display">\[\Large a \times \sum_{j=1}^b (\bar{y}_j
- \bar{y}_.)^2\]</span></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">mothData</span><span class="op">$</span><span class="va">Treatment</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">SS.block</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">block.means</span><span class="op">$</span><span class="va">mu</span> <span class="op">-</span> <span class="va">grand.mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 430.9</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="within-groups-sums-of-squares">Within groups sums of squares<a class="anchor" aria-label="anchor" href="#within-groups-sums-of-squares"></a>
</h4>
<p><span class="math display">\[\Large \sum_{i=1}^a \sum_{j=1}^b (y_{ij}
- \bar{y}_i - \bar{y}_j + \bar{y}_.)^2\]</span></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatment.means.long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">treatment.means</span><span class="op">$</span><span class="va">mu</span>, each <span class="op">=</span> <span class="va">b</span><span class="op">)</span></span>
<span><span class="va">block.means.long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">block.means</span><span class="op">$</span><span class="va">mu</span>, times <span class="op">=</span> <span class="va">a</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">SS.within</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">mothData</span><span class="op">$</span><span class="va">caterpillar</span> <span class="op">-</span> <span class="va">treatment.means.long</span> <span class="op">-</span> <span class="va">block.means.long</span> <span class="op">+</span> <span class="va">grand.mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 114.8</span></span></code></pre></div>
<hr>
<p><strong>NOTE</strong>: For the above code to work,
<code>treatment.means</code> and <code>block.means</code> must be in the
same order as in the original data.</p>
<hr>
</div>
<div class="section level4">
<h4 id="create-anova-table">Create ANOVA table<a class="anchor" aria-label="anchor" href="#create-anova-table"></a>
</h4>
<p>Now we’re ready to create the ANOVA table. Start with what we’ve
calculated so far:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df.treat</span> <span class="op">&lt;-</span> <span class="va">a</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">df.block</span> <span class="op">&lt;-</span> <span class="va">b</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">df.within</span> <span class="op">&lt;-</span> <span class="va">df.treat</span><span class="op">*</span><span class="va">df.block</span></span>
<span><span class="va">ANOVAtable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">df.treat</span>, <span class="va">df.block</span>, <span class="va">df.within</span><span class="op">)</span>,</span>
<span>                         SS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">SS.treat</span>, <span class="va">SS.block</span>, <span class="va">SS.within</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ANOVAtable</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treatment"</span>, <span class="st">"Block"</span>, <span class="st">"Within"</span><span class="op">)</span></span>
<span><span class="va">ANOVAtable</span></span>
<span><span class="co">#&gt;           df    SS</span></span>
<span><span class="co">#&gt; Treatment  2 223.2</span></span>
<span><span class="co">#&gt; Block      3 430.9</span></span>
<span><span class="co">#&gt; Within     6 114.8</span></span></code></pre></div>
<p>Next, add the mean squares:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MSE</span> <span class="op">&lt;-</span> <span class="va">ANOVAtable</span><span class="op">$</span><span class="va">SS</span> <span class="op">/</span> <span class="va">ANOVAtable</span><span class="op">$</span><span class="va">df</span></span>
<span><span class="va">ANOVAtable</span><span class="op">$</span><span class="va">MSE</span> <span class="op">&lt;-</span> <span class="va">MSE</span> <span class="co">## makes a new column!</span></span></code></pre></div>
<p>Now, the <em>F</em>-values (with <code>NA</code> for
error/within/residual row):</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">F.stat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">MSE</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">MSE</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">MSE</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">MSE</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">ANOVAtable</span><span class="op">$</span><span class="va">F.stat</span> <span class="op">&lt;-</span> <span class="va">F.stat</span></span></code></pre></div>
<p>Finally, the <em>p</em>-values</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">F.stat</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">F.stat</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">ANOVAtable</span><span class="op">$</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span></span></code></pre></div>
<hr>
<p>Quick reminder about calculating <em>p</em>-values</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">qf</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span> <span class="co"># 95% of the distribution is below this value of F</span></span>
<span><span class="co">#&gt; [1] 5.143</span></span>
<span></span>
<span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">pf</a></span><span class="op">(</span><span class="va">F.stat</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span> <span class="co"># Proportion of the distribution beyond this F value</span></span>
<span><span class="co">#&gt; [1] 0.03922</span></span></code></pre></div>
<p>Be sure you understand what each of these functions is doing!</p>
<hr>
<p>And we’ll display the table using <code><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable()</a></code>, with a few
options to make it look a little nicer:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>knitr.kable.NA <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="co"># leave NA cells empty</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">ANOVAtable</span>, digits <span class="op">=</span> <span class="fl">2</span>, align <span class="op">=</span> <span class="st">"c"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"df"</span>, <span class="st">"SS"</span>, <span class="st">"MSE"</span>, <span class="st">"F"</span>, <span class="st">"p-value"</span><span class="op">)</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"RCBD ANOVA table calculated by hand"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>RCBD ANOVA table calculated by hand</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="center">df</th>
<th align="center">SS</th>
<th align="center">MSE</th>
<th align="center">F</th>
<th align="center">p-value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Treatment</td>
<td align="center">2</td>
<td align="center">223.2</td>
<td align="center">111.58</td>
<td align="center">5.83</td>
<td align="center">0.04</td>
</tr>
<tr class="even">
<td align="left">Block</td>
<td align="center">3</td>
<td align="center">430.9</td>
<td align="center">143.64</td>
<td align="center">7.51</td>
<td align="center">0.02</td>
</tr>
<tr class="odd">
<td align="left">Within</td>
<td align="center">6</td>
<td align="center">114.8</td>
<td align="center">19.14</td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="blocked-anova-using-aov">Blocked ANOVA using <code>aov()</code><a class="anchor" aria-label="anchor" href="#blocked-anova-using-aov"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aov1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">caterpillar</span> <span class="op">~</span> <span class="va">Treatment</span> <span class="op">+</span> <span class="va">Region</span>, <span class="va">mothData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov1</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; Treatment    2    223   111.6    5.83  0.039 *</span></span>
<span><span class="co">#&gt; Region       3    431   143.6    7.51  0.019 *</span></span>
<span><span class="co">#&gt; Residuals    6    115    19.1                 </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Same as what we got by hand! Look what happens if we ignore the
blocking variable:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aov2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">caterpillar</span> <span class="op">~</span> <span class="va">Treatment</span>, <span class="va">mothData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov2</span><span class="op">)</span></span>
<span><span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; Treatment    2    223   111.6    1.84   0.21</span></span>
<span><span class="co">#&gt; Residuals    9    546    60.6</span></span></code></pre></div>
<hr>
<p>Why is the effect of pesticide no longer significant?</p>
<hr>
</div>
<div class="section level3">
<h3 id="treating-block-effects-as-random-effects">Treating block effects as random effects<a class="anchor" aria-label="anchor" href="#treating-block-effects-as-random-effects"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aov3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov</a></span><span class="op">(</span><span class="va">caterpillar</span> <span class="op">~</span> <span class="va">Treatment</span> <span class="op">+</span> <span class="fu">Error</span><span class="op">(</span><span class="va">Region</span><span class="op">)</span>, <span class="va">mothData</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">aov3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Error: Region</span></span>
<span><span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; Residuals  3    431     144               </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Error: Within</span></span>
<span><span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; Treatment  2    223   111.6    5.83  0.039 *</span></span>
<span><span class="co">#&gt; Residuals  6    115    19.1                 </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The values of the ANOVA table are the same as before, and there is no
reason to use random effects here if interest only lies in testing the
null hypothesis concerning pesticides.</p>
<p>Later, we will see cases where it is important to use random and
fixed effects.</p>
</div>
</div>
<div class="section level2">
<h2 id="assignment-not-for-a-grade">Assignment (not for a grade)<a class="anchor" aria-label="anchor" href="#assignment-not-for-a-grade"></a>
</h2>
<p>Some time ago, plantations of <em>Pinus caribaea</em> were
established at four locations on Puerto Rico. As part of a spacing
study, four spacings were used at each location to determine the effect
of four specific spacing intervals on tree height. Twenty years after
the plantations were established, measurements were made in the study
plots as follows:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Location</th>
<th align="center">Spacing (ft)</th>
<th align="left">Height (ft)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Caracoles</td>
<td align="center">5</td>
<td align="left">72</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center">7</td>
<td align="left">80</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center">10</td>
<td align="left">85</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center">14</td>
<td align="left">91</td>
</tr>
<tr class="odd">
<td align="left">Utuado</td>
<td align="center">5</td>
<td align="left">75</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center">7</td>
<td align="left">90</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center">10</td>
<td align="left">94</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center">14</td>
<td align="left">112</td>
</tr>
<tr class="odd">
<td align="left">Guzman</td>
<td align="center">5</td>
<td align="left">88</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center">7</td>
<td align="left">95</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center">10</td>
<td align="left">94</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center">14</td>
<td align="left">91</td>
</tr>
<tr class="odd">
<td align="left">Lares</td>
<td align="center">5</td>
<td align="left">79</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center">7</td>
<td align="left">94</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center">10</td>
<td align="left">104</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center">14</td>
<td align="left">106</td>
</tr>
</tbody>
</table>
<p>You can access these data using:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">FANR6750</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"pineData"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Questions/tasks</strong></p>
<ol style="list-style-type: decimal">
<li><p>What is the primary null hypothesis of interest? State it, and
the associated alternative hypothesis, as comments in the file</p></li>
<li><p>Test for effects of location and spacing on plant height using
the <code><a href="https://rdrr.io/r/stats/aov.html" class="external-link">aov()</a></code> function. NOTE: spacing must be treated as a
factor, not as a numeric vector</p></li>
<li><p>Perform a Tukey test to determine which spacings differ</p></li>
</ol>
<p>Put your answers in an R Markdown report. Your report should
include:</p>
<ol style="list-style-type: decimal">
<li><p>A well-formatted ANOVA table (with caption); and</p></li>
<li><p>A publication-quality plot (or plots) of the estimated effect of
location and spacing on plant height. The figure(s) should also have a
descriptive caption and any aesthetics (color, line type, etc.) should
be clearly defined.</p></li>
</ol>
<p>You may format the report however you like but it should be
well-organized, with relevant headers, plain text, and the elements
described above.</p>
<p>As always:</p>
<ul>
<li><p>Be sure the output type is set to:
<code>output: html_document</code></p></li>
<li><p>Be sure to set <code>echo = TRUE</code> in all <code>R</code>
chunks</p></li>
<li><p>See the R Markdown reference sheet for help with creating
<code>R</code> chunks, equations, tables, etc.</p></li>
<li><p>See the “Creating publication-quality graphics” reference sheet
for tips on formatting figures</p></li>
</ul>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Under the hood, <code>R</code> actually treats factors
as integers - 1, 2, 3… - with character labels for each level<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Clark Rushing.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
